<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Describe and manipulate single-case data frames | Analyzing single-case data with R and scan</title>
  <meta name="description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Describe and manipulate single-case data frames | Analyzing single-case data with R and scan" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />
  <meta name="github-repo" content="jazznbass/scan-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Describe and manipulate single-case data frames | Analyzing single-case data with R and scan" />
  
  <meta name="twitter:description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />
  

<meta name="author" content="JÃ¼rgen Wilbert" />


<meta name="date" content="2019-08-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-a-single-case-data-plot.html">
<link rel="next" href="overlapping-indices.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145080763-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145080763-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
Analyzing single-case data with R and scan

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="some-things-about-r.html"><a href="some-things-about-r.html"><i class="fa fa-check"></i><b>2</b> Some things about R</a><ul>
<li class="chapter" data-level="2.1" data-path="some-things-about-r.html"><a href="some-things-about-r.html#basic-r"><i class="fa fa-check"></i><b>2.1</b> Basic R</a></li>
<li class="chapter" data-level="2.2" data-path="some-things-about-r.html"><a href="some-things-about-r.html#installing-the-scan-package"><i class="fa fa-check"></i><b>2.2</b> Installing the <em>scan</em> package</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html"><i class="fa fa-check"></i><b>3</b> Managing single-case data</a><ul>
<li class="chapter" data-level="3.1" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html#a-single-case-data-frame"><i class="fa fa-check"></i><b>3.1</b> A <strong><em>single-case data frame</em></strong></a></li>
<li class="chapter" data-level="3.2" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html#creating-scdfs"><i class="fa fa-check"></i><b>3.2</b> Creating scdfs</a></li>
<li class="chapter" data-level="3.3" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html#saving-and-reading-single-case-data-frames"><i class="fa fa-check"></i><b>3.3</b> Saving and reading <em>single-case data frames</em></a></li>
<li class="chapter" data-level="3.4" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html#import-and-export-single-case-data-frames"><i class="fa fa-check"></i><b>3.4</b> Import and export <em>single-case data frames</em></a></li>
<li class="chapter" data-level="3.5" data-path="managing-single-case-data.html"><a href="managing-single-case-data.html#displaying-and-manipulating-scdf-files"><i class="fa fa-check"></i><b>3.5</b> Displaying and manipulating scdf-files</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="creating-a-single-case-data-plot.html"><a href="creating-a-single-case-data-plot.html"><i class="fa fa-check"></i><b>4</b> Creating a single-case data plot</a><ul>
<li class="chapter" data-level="4.1" data-path="creating-a-single-case-data-plot.html"><a href="creating-a-single-case-data-plot.html#graphical-styles-of-a-plot"><i class="fa fa-check"></i><b>4.1</b> Graphical styles of a plot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html"><i class="fa fa-check"></i><b>5</b> Describe and manipulate single-case data frames</a><ul>
<li class="chapter" data-level="5.1" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html#describing-and-summarizing"><i class="fa fa-check"></i><b>5.1</b> Describing and summarizing</a></li>
<li class="chapter" data-level="5.2" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html#autoregression-and-trendanalyses"><i class="fa fa-check"></i><b>5.2</b> Autoregression and trendanalyses</a></li>
<li class="chapter" data-level="5.3" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html#missing-values"><i class="fa fa-check"></i><b>5.3</b> Missing values</a></li>
<li class="chapter" data-level="5.4" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html#outlieranalysis"><i class="fa fa-check"></i><b>5.4</b> Outlieranalysis</a></li>
<li class="chapter" data-level="5.5" data-path="describe-and-manipulate-single-case-data-frames.html"><a href="describe-and-manipulate-single-case-data-frames.html#smoothing-data"><i class="fa fa-check"></i><b>5.5</b> Smoothing data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="overlapping-indices.html"><a href="overlapping-indices.html"><i class="fa fa-check"></i><b>6</b> Overlapping indices</a><ul>
<li class="chapter" data-level="6.1" data-path="overlapping-indices.html"><a href="overlapping-indices.html#percentage-non-overlapping-data-pnd"><i class="fa fa-check"></i><b>6.1</b> Percentage non-overlapping data (PND)</a></li>
<li class="chapter" data-level="6.2" data-path="overlapping-indices.html"><a href="overlapping-indices.html#percentage-exceeding-the-median-pem"><i class="fa fa-check"></i><b>6.2</b> Percentage exceeding the median (PEM)</a></li>
<li class="chapter" data-level="6.3" data-path="overlapping-indices.html"><a href="overlapping-indices.html#percentage-exceeding-the-regression-trend-pet"><i class="fa fa-check"></i><b>6.3</b> Percentage exceeding the regression trend (PET)</a></li>
<li class="chapter" data-level="6.4" data-path="overlapping-indices.html"><a href="overlapping-indices.html#percentage-of-all-non-overlapping-data-pand"><i class="fa fa-check"></i><b>6.4</b> Percentage of all non-overlapping data (PAND)</a></li>
<li class="chapter" data-level="6.5" data-path="overlapping-indices.html"><a href="overlapping-indices.html#nonoverlap-of-all-pairs-nap"><i class="fa fa-check"></i><b>6.5</b> Nonoverlap of all pairs (NAP)</a></li>
<li class="chapter" data-level="6.6" data-path="overlapping-indices.html"><a href="overlapping-indices.html#tau-u"><i class="fa fa-check"></i><b>6.6</b> Tau-U</a></li>
<li class="chapter" data-level="6.7" data-path="overlapping-indices.html"><a href="overlapping-indices.html#reliable-change-index"><i class="fa fa-check"></i><b>6.7</b> Reliable change index</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html"><i class="fa fa-check"></i><b>7</b> Piecewise linear regressions</a><ul>
<li class="chapter" data-level="7.1" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html#the-basic-plm-function"><i class="fa fa-check"></i><b>7.1</b> The basic plm function</a><ul>
<li class="chapter" data-level="7.1.1" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html#dummy-model"><i class="fa fa-check"></i><b>7.1.1</b> Dummy model</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html#different-modells"><i class="fa fa-check"></i><b>7.2</b> Different modells</a></li>
<li class="chapter" data-level="7.3" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html#modelling-autoregression"><i class="fa fa-check"></i><b>7.3</b> Modelling autoregression</a></li>
<li class="chapter" data-level="7.4" data-path="piecewise-linear-regressions.html"><a href="piecewise-linear-regressions.html#adding-additional-predictors"><i class="fa fa-check"></i><b>7.4</b> Adding additional predictors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multilevel-regression-analyses.html"><a href="multilevel-regression-analyses.html"><i class="fa fa-check"></i><b>8</b> Multilevel regression analyses</a><ul>
<li class="chapter" data-level="8.1" data-path="multilevel-regression-analyses.html"><a href="multilevel-regression-analyses.html#adding-additional-l2-variables"><i class="fa fa-check"></i><b>8.1</b> Adding additional L2-variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="randomization-tests.html"><a href="randomization-tests.html"><i class="fa fa-check"></i><b>9</b> Randomization tests</a></li>
<li class="chapter" data-level="10" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html"><i class="fa fa-check"></i><b>10</b> Exporting <em>scan</em> results</a><ul>
<li class="chapter" data-level="10.1" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html#single-case-data-files"><i class="fa fa-check"></i><b>10.1</b> Single case data files</a></li>
<li class="chapter" data-level="10.2" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html#descriptive-stats"><i class="fa fa-check"></i><b>10.2</b> Descriptive stats</a></li>
<li class="chapter" data-level="10.3" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html#overlap-indices"><i class="fa fa-check"></i><b>10.3</b> Overlap indices</a></li>
<li class="chapter" data-level="10.4" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html#piecewise-linear-models"><i class="fa fa-check"></i><b>10.4</b> Piecewise linear models</a></li>
<li class="chapter" data-level="10.5" data-path="exporting-scan-results.html"><a href="exporting-scan-results.html#hierarchical-piecewise-regressions"><i class="fa fa-check"></i><b>10.5</b> Hierarchical piecewise regressions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
Published with bookdown

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyzing single-case data with R and scan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="describe-and-manipulate-single-case-data-frames" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Describe and manipulate single-case data frames</h1>
<div id="describing-and-summarizing" class="section level2">
<h2><span class="header-section-number">5.1</span> Describing and summarizing</h2>
<p>A short description of the <em>scdf</em> is provided by the <code>summary</code> command. The results are pretty much self explaining</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">summary</span>(Huber2014)</a></code></pre></div>
<pre><code>## #A single-case data frame with 4 cases
## 
##           Measurements Design
## Adam                37    A B
## Berta               29    A B
## Christian           76    A B
## David               76    A B
## 
## Variable names:
## mt &lt;measurement-time variable&gt;
## compliance &lt;dependent variable&gt;
## phase &lt;phase variable&gt;
## 
## 
## Note:  Behavioral data (compliance in percent).
## Author of data:  Christian Huber</code></pre>
<p><code>describeSC</code> is the basic command to get an overview on descriptive statistics. As an argument it only takes the name of the <em>scdf</em> object. For each case of the <em>scdf</em> and each phase within a case descriptive statistics are provided. The output table contains statistical indicators followed by a dot and the name of the phase (e.g., <code>n.A</code> for the number of measurements of phase A).</p>
<table style="width:90%;">
<caption>Statistics of the describeSC command</caption>
<colgroup>
<col width="16%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">What it means â¦</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="left">Number of measurements.</td>
</tr>
<tr class="even">
<td align="left">mis</td>
<td align="left">Number of missing values.</td>
</tr>
<tr class="odd">
<td align="left">m</td>
<td align="left">Mean values.</td>
</tr>
<tr class="even">
<td align="left">md</td>
<td align="left">Median of values.</td>
</tr>
<tr class="odd">
<td align="left">sd</td>
<td align="left">Standard deviation of values.</td>
</tr>
<tr class="even">
<td align="left">mad</td>
<td align="left">Median average deviation of values.</td>
</tr>
<tr class="odd">
<td align="left">min/max</td>
<td align="left">Min and max of values.</td>
</tr>
<tr class="even">
<td align="left">trend</td>
<td align="left">Slope of a regression line through values by time.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">describeSC</span>(exampleABC)</a></code></pre></div>
<pre><code>## Describe Single-Case Data
## 
## Design:  A B C 
## 
##         Marie Rosalind Lise
##     n.A    10       15   20
##     n.B    10        8    7
##     n.C    10        7    3
##   mis.A     0        0    0
##   mis.B     0        0    0
##   mis.C     0        0    0
## 
##         Marie Rosalind   Lise
##     m.A 52.00    52.27  52.35
##     m.B 72.10    73.25  73.57
##     m.C 68.00    66.43  71.33
##    md.A 53.50    52.00  52.00
##    md.B 72.50    72.00  73.00
##    md.C 69.00    68.00  76.00
##    sd.A  8.29     8.15  10.87
##    sd.B 11.37    13.13  10.64
##    sd.C 12.70    10.49  21.39
##   mad.A 11.12     7.41  10.38
##   mad.B 10.38    10.38  16.31
##   mad.C 17.79    11.86  20.76
##   min.A 39.00    37.00  35.00
##   min.B 47.00    54.00  60.00
##   min.C 51.00    52.00  48.00
##   max.A 63.00    65.00  74.00
##   max.B 85.00    97.00  87.00
##   max.C 87.00    78.00  90.00
## trend.A -1.92     0.50  -0.09
## trend.B -0.61     0.64   1.93
## trend.C -0.19    -2.93 -14.00</code></pre>
<p>The resulting table could be exported into a csv file to be used in other software (e.g., to inserted in a word processing document). Therefore, first write the results of the <code>describeSC</code> command into an R object and then use the <code>write.csv</code> (or <code>write.csv2</code> for a German OS system setup) to export the <code>descriptives</code> element of the object.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># write the results into a new R object named `res`</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">res &lt;-<span class="st"> </span><span class="kw">describeSC</span>(exampleABC)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co"># create a new file containing the descriptives on your harddrive</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="kw">write.csv</span>(res<span class="op">$</span>descriptives, <span class="dt">file =</span> <span class="st">&quot;descriptive data.csv&quot;</span>)</a></code></pre></div>
<p>The file is written to the currently active working directory. If you are not sure where that is, type <code>getwd()</code> (you can use the <code>setwd()</code> command to define a different working directory. To get further details type <code>help(setwd)</code> into R).</p>
</div>
<div id="autoregression-and-trendanalyses" class="section level2">
<h2><span class="header-section-number">5.2</span> Autoregression and trendanalyses</h2>
<p>The <code>autocorrSC</code> function calculates autocorrelations within each phase and across all phases. The <code>lag.max</code> argument defines the lag up to which the autocorrelation will be computed.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">autocorrSC</span>(exampleABC, <span class="dt">lag.max =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## Autocorrelations
## 
##      case phase lag_1 lag_2 lag_3 lag_4
##     Marie     A  0.29 -0.11  0.10  0.12
##     Marie     B -0.28 -0.10 -0.14 -0.09
##     Marie     C  0.00 -0.33 -0.14 -0.25
##     Marie   all  0.21  0.10  0.25  0.12
##  Rosalind     A  0.37 -0.29 -0.33 -0.34
##  Rosalind     B -0.34  0.24 -0.40  0.04
##  Rosalind     C -0.07 -0.32  0.27  0.02
##  Rosalind   all  0.49  0.38  0.22  0.17
##      Lise     A  0.04 -0.32 -0.05 -0.09
##      Lise     B -0.63  0.50 -0.40  0.31
##      Lise     C -0.38 -0.12    NA    NA
##      Lise   all  0.33  0.36  0.23  0.27</code></pre>
<p>The <code>trendSC</code> function provides an overview of linear trends in single-case data. By default, it gives you the intercept and slope of a linear and a squared regression of measurement-time on scores. Models are computed separately for each phase and across all phases. For a more advanced application, you can add regression models using the R specific formula class.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># Simple example</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="kw">trendSC</span>(exampleABC[<span class="dv">1</span>])</a></code></pre></div>
<pre><code>## Trend for each phase
## 
##             Intercept      B   Beta
## Linear.ALL     55.159  0.612  0.392
## Linear.A       60.618 -1.915 -0.700
## Linear.B       74.855 -0.612 -0.163
## Linear.C       68.873 -0.194 -0.046
## Squared.ALL    59.135  0.017  0.330
## Squared.A      57.937 -0.208 -0.712
## Squared.B      73.217 -0.039 -0.098
## Squared.C      68.490 -0.017 -0.038
## 
## Note. Measurement-times of phase B start at 0</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Complex example</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">trendSC</span>(exampleAB<span class="op">$</span>Johanna, <span class="dt">offset =</span> <span class="dv">0</span>, <span class="dt">model =</span> <span class="kw">c</span>(<span class="st">&quot;Cubic&quot;</span> =<span class="st"> </span>values <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(mt<span class="op">^</span><span class="dv">3</span>), <span class="st">&quot;Log Time&quot;</span> =<span class="st"> </span>values <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(mt)))</a></code></pre></div>
<pre><code>## Trend for each phase
## 
##              Intercept      B   Beta
## Linear.ALL      50.484  1.787  0.908
## Linear.A        54.300  0.100  0.066
## Linear.B        61.133  1.625  0.813
## Squared.ALL     57.879  0.079  0.871
## Squared.A       54.747 -0.013 -0.054
## Squared.B       66.343  0.094  0.775
## Cubic.ALL       60.886  0.004  0.816
## Cubic.A         54.959 -0.008 -0.169
## Cubic.B         68.368  0.006  0.732
## Log Time.ALL    43.532 12.149  0.848
## Log Time.A      54.032  0.593  0.156
## Log Time.B      57.300  9.051  0.791
## 
## Note. Measurement-times of phase B start at 1</code></pre>
</div>
<div id="missing-values" class="section level2">
<h2><span class="header-section-number">5.3</span> Missing values</h2>
<p>There are two kinds of missing values in single-case data series. First, missings that were explicitly recorded as <code>NA</code> and assigned to a phase and measurement-time as in the following example:</p>
<pre><code>scdf(c(5, 3, 4, 6, 8, 7, 9, 7, NA, 6), phase.design = c(A = 4, B = 6))</code></pre>
<p>The second type of missing occures when there are gaps between measuremnt-times that are not explicitly coded as in the following example:</p>
<pre><code>scdf(c(5, 3, 4, 6, 8, 7, 9, 7, 6), phase.design = c(A = 4, B = 5), 
     mt = c(1, 2, 3, 4, 5, 6, 7, 8, 10))</code></pre>
<p>In both cases, missing values pose a threat to the internal validity of overlap indices. Randomization tests are more robust against the first type of missing values but are affected by the second type. Regression approaches are less impacted by both types as they take the measurement-time into account.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">case1  &lt;-<span class="st"> </span><span class="kw">scdf</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">2</span>, <span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">6</span>), </a>
<a class="sourceLine" id="cb50-2" data-line-number="2">               <span class="dt">phase.design =</span> <span class="kw">c</span>(<span class="dt">A =</span> <span class="dv">10</span>, <span class="dt">B =</span> <span class="dv">10</span>), <span class="dt">name =</span> <span class="st">&quot;no NA&quot;</span>)</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">case2 &lt;-<span class="st"> </span><span class="kw">scdf</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>,<span class="dv">2</span>, <span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="ot">NA</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">6</span>), </a>
<a class="sourceLine" id="cb50-4" data-line-number="4">              <span class="dt">phase.design =</span> <span class="kw">c</span>(<span class="dt">A =</span> <span class="dv">10</span>, <span class="dt">B =</span> <span class="dv">10</span>), <span class="dt">name =</span> <span class="st">&quot;NAs&quot;</span>)</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">case3 &lt;-<span class="st"> </span><span class="kw">fillmissingSC</span>(case2)</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="kw">names</span>(case3) &lt;-<span class="st"> &quot;interpolated NAs&quot;</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">ex &lt;-<span class="st"> </span><span class="kw">c</span>(case1, case2, case3)</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="kw">plot</span>(ex, <span class="dt">style =</span> <span class="st">&quot;grid&quot;</span>)</a></code></pre></div>
<p><img src="scan-book_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">overlapSC</span>(ex)</a></code></pre></div>
<pre><code>## Overlap Indices
## 
## Design:  A B 
## Comparing phase 1 against phase 2 
## 
##               no NA    NAs interpolated NAs
## PND           40.00  33.33            30.00
## PEM          100.00 100.00           100.00
## PET          100.00 100.00           100.00
## NAP           88.50  91.36            91.50
## NAP.rescaled  77.00  82.72            83.00
## PAND          72.50  80.56            80.00
## TAU_U          0.42   0.39             0.47
## Base_Tau       0.59   0.64             0.64
## Diff_mean      2.60   2.78             2.75
## Diff_trend     0.02   0.11             0.12
## SMD            1.65   1.96             2.02</code></pre>
</div>
<div id="outlieranalysis" class="section level2">
<h2><span class="header-section-number">5.4</span> Outlieranalysis</h2>
<p><em>scan</em> provides several methods for analyzing outliers. All of them are implemented in the <code>outliersSC</code> function. Available methods are the <strong>standard deviation</strong>, <strong>mean average deviation</strong>, <strong>confidence intervalls</strong>, and <strong>Cookâs distance</strong>. The criteria argument takes a vector with two information, the first defines the analyzing method (âSDâ, âMADâ, CIâ,âCookâ) and the second the criteria. ForâSD&quot; the criteria is the number of standard deviations (<strong>sd</strong>) from the mean of each phase for which a value is not considered to be an outlier. For example, <code>criteria = c(&quot;SD&quot;,2)</code> would identify every value exceeding two <strong>sd</strong> above or below the mean as an outlier whereas <strong>sd</strong> and mean refer to phase of a value. As this might be misleading particularly for small samples Iglewicz and Hoaglin <span class="citation">Iglewicz &amp; Hoaglin (<a href="#ref-iglewicz_how_1993">1993</a>)</span> recommend the use the much more robust median average deviation (<strong>MAD</strong>) instead. The <strong>MAD</strong> is is constructed similar to the <strong>sd</strong> but uses the median instead of the mean. Multiplying the <strong>MAD</strong> by 1.4826 approximates the <strong>sd</strong> in a normal distributed sample. This corrected MAD is applied in the <code>outlierSC</code> function. A deviation of 3.5 times the corrected <strong>MAD</strong> from the median is suggested to be an outlier. To use this criterion set <code>criteria = c(&quot;MAD&quot;, 3.5)</code>. <code>criteria = c(&quot;CI&quot;, 0.95)</code> takes exceeding the 95% confidence interval as the criteria for outliers. The Cookâs distance method for calculation outliers can be applied with a strict AB-phase design. in that case, the Cookâs distance analyses are based on a piecewise-regression model. Most commonly, Cookâs distance exceeding 4/n is used as a criteria. This could be implemented setting `criteria = c(âCookâ,â4/nâ).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw">outlierSC</span>(exampleABC_outlier, <span class="dt">criteria =</span> <span class="kw">c</span>(<span class="st">&quot;MAD&quot;</span>, <span class="fl">3.5</span>))</a></code></pre></div>
<pre><code>## Outlier Analysis for Single-Case Data
## 
## Criteria: Exceeds 3.5 Mean Average Deviations
## 
## $Bernadette
##   phase md mad   lower    upper
## 1     A 57   9 10.2981 103.7019
## 2     B 76   7 39.6763 112.3237
## 3     C 69  12  6.7308 131.2692
## 
## $Penny
##   phase md mad   lower    upper
## 1     A 52   6 20.8654  83.1346
## 2     B 74  10 22.1090 125.8910
## 3     C 68   8 26.4872 109.5128
## 
## $Amy
##   phase md mad   lower    upper
## 1     A 54   9  7.2981 100.7019
## 2     B 73  11 15.9199 130.0801
## 3     C 76  14  3.3526 148.6474
## 
## Case Bernadette : Dropped 3 
## Case Penny : Dropped 2 
## Case Amy : Dropped 3</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co"># Visualizing outliers with the plot function</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2">res &lt;-<span class="st"> </span><span class="kw">outlierSC</span>(exampleABC_outlier, <span class="dt">criteria =</span> <span class="kw">c</span>(<span class="st">&quot;MAD&quot;</span>, <span class="fl">3.5</span>))</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">plot</span>(exampleABC_outlier, <span class="dt">marks =</span> res, </a>
<a class="sourceLine" id="cb55-4" data-line-number="4">     <span class="dt">style =</span> <span class="st">&quot;annotate&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">40</span>,<span class="dv">160</span>))</a></code></pre></div>
<p><img src="scan-book_files/figure-html/outlier-1.png" width="672" /></p>
</div>
<div id="smoothing-data" class="section level2">
<h2><span class="header-section-number">5.5</span> Smoothing data</h2>
<p>The smoothSC function provides procedures to smooth single-case data and eliminate noise. A moving average function (mean- or median-based) replaces each data point by the average of the surrounding data points step-by-step. A <em>lag</em> defines the number of measurements before and after the calculation is based on. So a lag-1 will take the average of the proceeding and following value and lag-2 the average of the two proceeding and two following measurements. With a local regression function, each data point is regressed by its surrounding data points. Here, the proportion of measurements surrounding a value is usually defined. So an intensity of 0.2 will take the surrounding 20% of data as the basis for a regression.<br />
The function returns am scdf with smoothed data points.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">## Use the three different smoothing functions and compare the results</a>
<a class="sourceLine" id="cb56-2" data-line-number="2">berta_mmd &lt;-<span class="st"> </span><span class="kw">smoothSC</span>(Huber2014<span class="op">$</span>Berta)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3">berta_mmn &lt;-<span class="st"> </span><span class="kw">smoothSC</span>(Huber2014<span class="op">$</span>Berta, <span class="dt">FUN =</span> <span class="st">&quot;movingMean&quot;</span>)</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">berta_lre &lt;-<span class="st"> </span><span class="kw">smoothSC</span>(Huber2014<span class="op">$</span>Berta, <span class="dt">FUN =</span> <span class="st">&quot;localRegression&quot;</span>)</a>
<a class="sourceLine" id="cb56-5" data-line-number="5">new.study &lt;-<span class="st"> </span><span class="kw">c</span>(Huber2014<span class="op">$</span>Berta, berta_mmd, berta_mmn, berta_lre)</a>
<a class="sourceLine" id="cb56-6" data-line-number="6"><span class="kw">names</span>(new.study) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>,<span class="st">&quot;Moving Median&quot;</span>,<span class="st">&quot;Moving Mean&quot;</span>,<span class="st">&quot;Local Regression&quot;</span>)</a>
<a class="sourceLine" id="cb56-7" data-line-number="7"><span class="kw">plotSC</span>(new.study, <span class="dt">style =</span> <span class="st">&quot;grid2&quot;</span>)</a></code></pre></div>
<p><img src="scan-book_files/figure-html/unnamed-chunk-28-1.png" width="480" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-iglewicz_how_1993">
<p>Iglewicz, B., &amp; Hoaglin, D. C. (1993). <em>How to detect and handle outliers</em>. Milwaukee, Wis. : ASQC Quality Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-a-single-case-data-plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="overlapping-indices.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["scan-book.pdf", "scan-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
