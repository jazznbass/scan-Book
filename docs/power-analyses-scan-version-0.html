<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan</title>

    <meta name="author" content="Jürgen Wilbert" />
  
   <meta name="description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan" />
  
  <meta name="twitter:description" content="This is a book on analyzing single-case data but also on how to do this using the R package scan" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.0/transition.js"></script>
    <script src="libs/bs3compat-0.4.0/tabs.js"></script>
    <script src="libs/bs3compat-0.4.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145080763-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-145080763-1');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
    <style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Analyzing single-case data with R and scan</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="power-analyses-scan-version-0.54-or-later" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Power analyses (scan version 0.54 or later)</h1>
<table>
 <tr>
  <td width="75px" style="background-color:#EEEEEE"><img src="images/function.png" alt="" height=49 width=45></td> 
  <td style="background-color:#EEEEEE"><font face="Courier New" size="2"> power_test(design, method = c("plm_level", "rand", "tauU"), effect = "level", n_sim = 100, design_is_one_study = TRUE, alpha_test = TRUE, power_test = TRUE, binom_test = FALSE, binom_test_alpha = FALSE, binom_test_power = FALSE, binom_test_correct = FALSE, ci = FALSE, alpha_level = 0.05) </font></td>
 </tr>
</table>  
<div id="the-idea-of-a-power-test" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> The idea of a power-test</h2>
<p>The <code>powert_test()</code> function provides the alpha error probability and power when analyzing a specific effect of a single-case design with a given statistical method.</p>
<p>For example, you have a one case design with phase length A = 10 and B = 20. You assume a strong level effect of d = 1 and you expect a slight trend effect of d = 0.02 (per measurement). You might be interested to answer two questions:</p>
<ol style="list-style-type: decimal">
<li>How suitable is a plm model for detecting the level-effect? (also: what is the power to detect the level effect?).</li>
<li>What if I had the same design but without a level-effect. How often would the plm falsely find a significant level-effect? (also: how large is the alpha-error probability for the level-effect?).</li>
</ol>
<p>In principle, <code>power_test()</code> takes a single case design and repeatedly generates random cases based on that design. Each case is now analyzed with a given statistical method. The proportion of significant effects in these analyses is an estimator of the test-power. In a second step the design is stripped of the target effect and again multiple cases are generated on this changed design and analyzed with the same method. Now, the proportion of significant effects is the estimator for the alpha-error probability.</p>
</div>
<div id="set-up-a-single-case-design" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Set up a single-case design</h2>
<table>
 <tr>
  <td width="75px" style="background-color:#EEEEEE"><img src="images/function.png" alt="" height=49 width=45></td> 
  <td style="background-color:#EEEEEE"><font face="Courier New" size="2"> design(n = 1, phase_design = list(A = 5, B = 15), trend = 0, level = list(0), slope = list(0), start_value = 50, s = 10, rtt = 0.8, extreme_prop = list(0), extreme_range = c(-4, -3), missing_prop = 0, distribution = "normal", n_trials = NULL, mt = NULL, B_start = NULL, m, MT) </font></td>
 </tr>
</table>  
<p>The <code>design</code> function sets up a single-case design. You can define various parameters of that design:</p>
<table class=" lightable-classic" style="width: auto !important; ">
<caption>
<span id="tab:design-arguments">Table 10.1: </span>Core arguments of the design function
</caption>
<thead>
<tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
What it does …
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
n
</td>
<td style="text-align:left;width: 30em; ">
Number of cases to be created (Default is n = 1).
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
phase_design
</td>
<td style="text-align:left;width: 30em; ">
A list defining the length and label of each phase. E.g., phase.length = list(A1 = 10, B1 = 10, A2 = 10, B2 = 10). Use vectors if you want to define different values for each case phase.length = list(A = c(10, 15), B = c(10, 15).
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
trend
</td>
<td style="text-align:left;width: 30em; ">
Defines the effect size of a trend added incrementally to each measurement across the whole data-set. To assign different trends to several single-cases, use a vector of values (e.g. trend = c(.1, .3, .5)). If the number of cases exceeds the length of the vector, values are recycled. When using a ‘gaussian’ distribution, the trend parameters indicate effect size d changes. When using a binomial or poisson distribution, trend indicates an increase in points / counts per measurement.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
level
</td>
<td style="text-align:left;width: 30em; ">
A list that defines the level increase (effect size d) at the beginning of each phase relative to the previous phase (e.g. list(A = 0, B = 1)). The first element must be zero as the first phase of a single-case has no level effect (if you have one less list element than the number of phases, scan will add a leading element with 0 values). Use vectors to define variable level effects for each case (e.g. list(A = c(0, 0), B = c(1, 2))). When using a ‘gaussian’ distribution, the level parameters indicate effect size d changes. When using a binomial or poisson distribution, level indicates an increase in points / counts with the onset of each phase.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
slope
</td>
<td style="text-align:left;width: 30em; ">
A list that defines the increase per measurement for each phase compared to the previous phase. slope = list(A = 0, B = .1 generates an incremental increase of 0.1 per measurement starting at the B phase. The first list element must be zero as the first phase of a single-case has no slope effect (if you have one less list element than the number of phases, scan will add a leading element with 0 values). Use vectors to define variable slope effects for each case (e.g. list(A = c(0, 0), B = c(0.1, 0.2))). If the number of cases exceeds the length of the vector, values are recycled. When using a ‘gaussian’ distribution, the slope parameters indicate effect size d changes per measurement. When using a binomial or poisson distribution, slope indicates an increase in points / counts per measurement.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
rtt
</td>
<td style="text-align:left;width: 30em; ">
Reliability of the underlying simulated measurements. Set rtt = .8 by default. To assign different reliabilities to several single-cases, use a vector of values (e.g. rtt = c(.6, .7, .8)). If the number of cases exceeds the length of the vector, values are repeated. rtt has no effect when you’re using binomial or poisson distributed scores.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
start_value
</td>
<td style="text-align:left;width: 30em; ">
Starting value at the first measurement. Default is 50. To assign different start values to several single-cases, use a vector of values (e.g. c(50, 42, 56)). If the number of cases exceeds the length of the vector, values are recycled.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
s
</td>
<td style="text-align:left;width: 30em; ">
Standard deviation used to calculate absolute values from level, slope, trend effects and to calculate and error distribution from the rtt values. Set to 10 by default. To assign different variances to several single-cases, use a vector of values (e.g. s = c(5, 10, 15)). If the number of cases exceeds the length of the vector, values are recycled. if the distribution is ‘poisson’ or ‘binomial’ s is not applied.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
extreme_prop
</td>
<td style="text-align:left;width: 30em; ">
Probability of extreme values. extreme.p = .05 gives a five percent probability of an extreme value. A vector of values assigns different probabilities to multiple cases. If the number of cases exceeds the length of the vector, values are repeated.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
extreme_range
</td>
<td style="text-align:left;width: 30em; ">
Range for extreme values, expressed as effect size d. extreme.d = c(-7,-6) uses extreme values within a range of -7 and -6 standard deviations. In case of a binomial or poisson distribution, extreme.d indicates points / counts. Caution: the first value must be smaller than the second, otherwise the procedure will fail.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
missing_prop
</td>
<td style="text-align:left;width: 30em; ">
Portion of missing values. missing.p = 0.1 creates 10% of all values as missing). A vector of values assigns different probabilities to multiple cases. If the number of cases exceeds the length of the vector, values are repeated.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
distribution
</td>
<td style="text-align:left;width: 30em; ">
Distribution of the scores. Default is distribution = ‘normal’. Possible values are ‘normal’ (or ‘gaussian’), ‘binomial’, and ‘poisson’.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
prob
</td>
<td style="text-align:left;width: 30em; ">
If distribution is set ‘binomial’, prob passes the probability of occurrence.
</td>
</tr>
</tbody>
</table>
</div>
<div id="conducting-a-power-test" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Conducting a power-test</h2>
<p>When conduction a power test, you firstly need to define a design which you like to be tested.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="power-analyses-scan-version-0.html#cb132-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">design</span>(</span>
<span id="cb132-2"><a href="power-analyses-scan-version-0.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb132-3"><a href="power-analyses-scan-version-0.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">phase_design =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">B =</span> <span class="dv">20</span>),</span>
<span id="cb132-4"><a href="power-analyses-scan-version-0.html#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">0</span>, <span class="at">B =</span> <span class="dv">1</span>),</span>
<span id="cb132-5"><a href="power-analyses-scan-version-0.html#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trend =</span> <span class="fl">0.02</span>,</span>
<span id="cb132-6"><a href="power-analyses-scan-version-0.html#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb132-7"><a href="power-analyses-scan-version-0.html#cb132-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Then you have to choose the statistical method. The <code>power_test</code> function applies three methods by default: <em>plm</em>, <em>randomization test</em>, and <em>Tau U</em>. These default values are only suitable when your design is a one case single-case study.</p>
<p>Let us start with the defaults and conduct a power analysis for our previously set design: <em>(This might take some time. Even in the default setting with 100 simulations you might wait a few seconds. For more precise estimations I recommend 1000 simulations - or even higher.)</em></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="power-analyses-scan-version-0.html#cb133-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design)</span>
<span id="cb133-2"><a href="power-analyses-scan-version-0.html#cb133-2" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct
 plm_level    73           5      1:5.4      84
      rand    67          10      1:3.3      78
      tauU   100          25      1:0.0      88</code></pre>
<p>The results show that the plm test and the randomization test have similar power and alpha-error probabilities (the differences here may be due to outliers of the random samples. A more intensive computation with 1000 simulations shows slightly better values for the plm). The tau U test has an unacceptably high alpha-error which is due to the trend we put into the design. <em>Alpha:Beta</em> depicts the relation of the Alpha and Beta error (power = 1 - Beta). <em>Correct</em> is the overall proportion of correct categorizations and <em>p</em> is the results of a binomial-test of <em>Correct</em> against 50%.</p>
</div>
<div id="statistical-methods" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Statistical methods</h2>
<p>The <code>method</code> argument takes a list where each element depicts a statistical method. Currently, the following character strings are predefined:</p>
<table class=" lightable-classic" style="width: auto !important; ">
<caption>
<span id="tab:table-mc-func">Table 10.2: </span>Statistical methods
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Single/ multiple cases
</th>
<th style="text-align:left;">
What it means …
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_level
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A complete plm model for normal distributed dependent variables. It checks for the level effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_slope
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A complete plm model for normal distributed dependent variables. It checks for the slope effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_poisson_level
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
Like plm_level but for poisson distributed dependent variables.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_poisson_slope
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
Like plm_slope but for poisson distributed dependent variables.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
hplm_level
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
A complete hplm model for normal distributed dependent variables. It checks for the level effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
hplm_slope
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
A complete hplm model for normal distributed dependent variables. It checks for the slope effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU
</td>
<td style="text-align:left;width: 7em; ">
sinlge
</td>
<td style="text-align:left;">
A tauU test with method complete and taub estimations. It checks the ‘A vs. B - Trend A’ variation.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_slope
</td>
<td style="text-align:left;width: 7em; ">
sinlge
</td>
<td style="text-align:left;">
A tauU test with method complete and taub estimations. It checks the ‘A vs. B - Trend A + Trend B’ variation.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_meta
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
Like ‘TauU’ but with the results from a meta analyses (fixed effects). Very slow.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_slope_meta
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
Like ‘TauU_slope’ but with the results from a meta analyses (fixed effects). Very slow.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
base_tau
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A baseline corrected tau test.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
rand
</td>
<td style="text-align:left;width: 7em; ">
single and multiple
</td>
<td style="text-align:left;">
A randomization test for ‘Mean B-A’ with 100 permutations.
</td>
</tr>
</tbody>
</table>
</div>
<div id="confidence-intervals-and-binomial-tests" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Confidence intervals and binomial tests</h2>
<p>With only 100 simulations you will have quite large confidence intervals for the power, alpha error probability, and correct estimations. You can calculate these intervals by setting the <code>ci</code> argument. For 95% CI’s set <code>ci = 0.95</code> for 99% <code>ci = 0.99</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="power-analyses-scan-version-0.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_test</span>(design, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power 2.5% 97.5% Alpha Error 2.5% 97.5% Alpha:Beta Correct 2.5%
 plm_level    77   68    85           5    2    11      1:4.6      86   80
      rand    68   58    77           8    4    15      1:4.0      80   74
      tauU   100   96   100          28   19    38      1:0.0      86   80
 97.5%
    90
    85
    90</code></pre>
<p>You can also test the power, alpha error, and correct estimates against predefined values. In order to do that, set <code>binom_test = TRUE</code>. The power will be tested against being greater or equal to 80%, the alpha error against being less or equal 5%, and the correct proportion against being greater equal 87.5%.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="power-analyses-scan-version-0.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_test</span>(design, <span class="at">binom_test =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct p Power&gt;=80 p Alpha Error&lt;=5
 plm_level    76           4      1:6.0      86           1                0
      rand    74           6      1:4.3      84           1                1
      tauU   100          22      1:0.0      89           0                1
 p Correct&gt;=87.5
             0.8
             0.9
             0.3</code></pre>
<p>If you want to define individual values for the three tests, set the <code>binom_test_power</code>. <code>binom_test_alpha</code>, and/or, the <code>binom_test_correct</code> arguments.</p>
</div>
<div id="advanced-methods" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Advanced methods</h2>
<p><em>Note: You need specific knowledge on how to create functions in R and on data structures to follow all aspects of this section.</em></p>
<p>Instead of one of the predefined character strings you can also create you own functions and implement these. You function must take an scdf as the first argument and return a single numeric p-value.</p>
<p>Here is an example that implements a method for the significance of a NAP (nonoverlap of all pairs) test. This is statistically identical to a U-Test comparing phase A and B.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="power-analyses-scan-version-0.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># only needed to make this example replicable</span></span>
<span id="cb139-2"><a href="power-analyses-scan-version-0.html#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="power-analyses-scan-version-0.html#cb139-3" aria-hidden="true" tabindex="-1"></a>mcmethod_nap <span class="ot">&lt;-</span> <span class="cf">function</span>(scdf) {</span>
<span id="cb139-4"><a href="power-analyses-scan-version-0.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nap</span>(scdf)<span class="sc">$</span>nap[<span class="dv">1</span>, <span class="st">&quot;p&quot;</span>]</span>
<span id="cb139-5"><a href="power-analyses-scan-version-0.html#cb139-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-6"><a href="power-analyses-scan-version-0.html#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="power-analyses-scan-version-0.html#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="fu">list</span>(<span class="at">nap =</span> mcmethod_nap, <span class="st">&quot;rand&quot;</span>, <span class="st">&quot;plm_level&quot;</span>))</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct
       nap   100          47      1:0.0      76
      rand    73           5      1:5.4      84
 plm_level    73           3      1:9.0      85</code></pre>
<p>Here is another example for a fast plm function for poisson distributed data based on the <code>fastglm</code> package:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="power-analyses-scan-version-0.html#cb141-1" aria-hidden="true" tabindex="-1"></a>plm_fast <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb141-2"><a href="power-analyses-scan-version-0.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">unlist</span>(data, <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb141-3"><a href="power-analyses-scan-version-0.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  y  <span class="ot">&lt;-</span> data<span class="sc">$</span>values</span>
<span id="cb141-4"><a href="power-analyses-scan-version-0.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>phase <span class="sc">==</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb141-5"><a href="power-analyses-scan-version-0.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>phase <span class="sc">==</span> <span class="st">&quot;B&quot;</span>)</span>
<span id="cb141-6"><a href="power-analyses-scan-version-0.html#cb141-6" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n1), <span class="fu">rep</span>(<span class="dv">1</span>, n2))</span>
<span id="cb141-7"><a href="power-analyses-scan-version-0.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  mt <span class="ot">&lt;-</span> data<span class="sc">$</span>mt</span>
<span id="cb141-8"><a href="power-analyses-scan-version-0.html#cb141-8" aria-hidden="true" tabindex="-1"></a>  inter <span class="ot">&lt;-</span> (mt <span class="sc">-</span> mt[n1]) <span class="sc">*</span> D</span>
<span id="cb141-9"><a href="power-analyses-scan-version-0.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb141-10"><a href="power-analyses-scan-version-0.html#cb141-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n1 <span class="sc">+</span> n2), mt, D, inter),</span>
<span id="cb141-11"><a href="power-analyses-scan-version-0.html#cb141-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> n1 <span class="sc">+</span> n2,</span>
<span id="cb141-12"><a href="power-analyses-scan-version-0.html#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">4</span></span>
<span id="cb141-13"><a href="power-analyses-scan-version-0.html#cb141-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb141-14"><a href="power-analyses-scan-version-0.html#cb141-14" aria-hidden="true" tabindex="-1"></a>  full <span class="ot">&lt;-</span> fastglm<span class="sc">::</span><span class="fu">fastglm</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">method =</span> <span class="dv">2</span>)</span>
<span id="cb141-15"><a href="power-analyses-scan-version-0.html#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(full)<span class="sc">$</span>coef[<span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb141-16"><a href="power-analyses-scan-version-0.html#cb141-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="power-analyses-scan-version-0.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;fast plm&quot;</span> <span class="ot">=</span> plm_fast))</span></code></pre></div>
</div>
<div id="computation-duration" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Computation duration</h2>
<p>You can print the returning object of the <code>power_test</code> function with added computation duration time by setting <code>duration = TRUE</code></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="power-analyses-scan-version-0.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">duration =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct
 plm_level    73           5      1:5.4      84
      rand    67          10      1:3.3      78
      tauU   100          25      1:0.0      88

Computation duration is 1.7 seconds.</code></pre>
<p>The duration depends heavily on the applied test methods. Regressions are faster than randomization tests and tau U tests are quiet slow:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="power-analyses-scan-version-0.html#cb145-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="st">&quot;plm_level&quot;</span>)</span>
<span id="cb145-2"><a href="power-analyses-scan-version-0.html#cb145-2" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="st">&quot;rand&quot;</span>)</span>
<span id="cb145-3"><a href="power-analyses-scan-version-0.html#cb145-3" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="st">&quot;tauU&quot;</span>)</span>
<span id="cb145-4"><a href="power-analyses-scan-version-0.html#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="power-analyses-scan-version-0.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Elapsed time in seconds for each procedure</span></span>
<span id="cb145-6"><a href="power-analyses-scan-version-0.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res1, <span class="st">&quot;computation_duration&quot;</span>)[<span class="dv">3</span>]</span>
<span id="cb145-7"><a href="power-analyses-scan-version-0.html#cb145-7" aria-hidden="true" tabindex="-1"></a>elapsed </span>
<span id="cb145-8"><a href="power-analyses-scan-version-0.html#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.144</span> </span>
<span id="cb145-9"><a href="power-analyses-scan-version-0.html#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res2, <span class="st">&quot;computation_duration&quot;</span>)[<span class="dv">3</span>]</span>
<span id="cb145-10"><a href="power-analyses-scan-version-0.html#cb145-10" aria-hidden="true" tabindex="-1"></a>elapsed </span>
<span id="cb145-11"><a href="power-analyses-scan-version-0.html#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.379</span> </span>
<span id="cb145-12"><a href="power-analyses-scan-version-0.html#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res3, <span class="st">&quot;computation_duration&quot;</span>)[<span class="dv">3</span>]</span>
<span id="cb145-13"><a href="power-analyses-scan-version-0.html#cb145-13" aria-hidden="true" tabindex="-1"></a>elapsed </span>
<span id="cb145-14"><a href="power-analyses-scan-version-0.html#cb145-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.257</span> </span></code></pre></div>
<p>… and what about our new fast-glm function?</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="power-analyses-scan-version-0.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb146-2"><a href="power-analyses-scan-version-0.html#cb146-2" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">design</span>(</span>
<span id="cb146-3"><a href="power-analyses-scan-version-0.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1</span>,</span>
<span id="cb146-4"><a href="power-analyses-scan-version-0.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">phase_design =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">10</span>, <span class="at">B =</span> <span class="dv">20</span>),</span>
<span id="cb146-5"><a href="power-analyses-scan-version-0.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="dv">0</span>, <span class="at">B =</span> <span class="dv">1</span>),</span>
<span id="cb146-6"><a href="power-analyses-scan-version-0.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trend =</span> <span class="fl">0.02</span>,</span>
<span id="cb146-7"><a href="power-analyses-scan-version-0.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb146-8"><a href="power-analyses-scan-version-0.html#cb146-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-9"><a href="power-analyses-scan-version-0.html#cb146-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-10"><a href="power-analyses-scan-version-0.html#cb146-10" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;fast plm&quot;</span> <span class="ot">=</span> plm_fast))</span>
<span id="cb146-11"><a href="power-analyses-scan-version-0.html#cb146-11" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">power_test</span>(design, <span class="at">method =</span> <span class="st">&quot;plm_poisson_level&quot;</span>)</span>
<span id="cb146-12"><a href="power-analyses-scan-version-0.html#cb146-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-13"><a href="power-analyses-scan-version-0.html#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res1, <span class="st">&quot;computation_duration&quot;</span>)[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>elapsed 
  0.215 </code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="power-analyses-scan-version-0.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(res2, <span class="st">&quot;computation_duration&quot;</span>)[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>elapsed 
  0.234 </code></pre>
<p>… it is much faster!</p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Analyzing single-case data with R and scan</strong>" was written by Jürgen Wilbert. It was last built on 2022-09-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
