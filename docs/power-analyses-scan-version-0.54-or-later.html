<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan</title>
<meta name="author" content="Jürgen Wilbert">
<meta name="description" content='power_test(design, method = c("plm_level", "rand", "tauU"), effect = "level", n_sim = 100, design_is_one_study = TRUE, alpha_test = TRUE, power_test = TRUE, binom_test = 0.5, alpha_level = 0.05)  ...'>
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan">
<meta property="og:type" content="book">
<meta property="og:description" content='power_test(design, method = c("plm_level", "rand", "tauU"), effect = "level", n_sim = 100, design_is_one_study = TRUE, alpha_test = TRUE, power_test = TRUE, binom_test = 0.5, alpha_level = 0.05)  ...'>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Power analyses (scan version 0.54 or later) | Analyzing single-case data with R and scan">
<meta name="twitter:description" content='power_test(design, method = c("plm_level", "rand", "tauU"), effect = "level", n_sim = 100, design_is_one_study = TRUE, alpha_test = TRUE, power_test = TRUE, binom_test = 0.5, alpha_level = 0.05)  ...'>
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-145080763-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-145080763-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Analyzing single-case data with R and scan</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">The Scan-Book</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="some-things-about-r.html"><span class="header-section-number">2</span> Some things about R</a></li>
<li><a class="" href="the-scan-package.html"><span class="header-section-number">3</span> The scan package</a></li>
<li><a class="" href="managing-single-case-data.html"><span class="header-section-number">4</span> Managing single-case data</a></li>
<li><a class="" href="creating-a-single-case-data-plot.html"><span class="header-section-number">5</span> Creating a single-case data plot</a></li>
<li><a class="" href="describe-and-manipulate-single-case-data-frames.html"><span class="header-section-number">6</span> Describe and manipulate single-case data frames</a></li>
<li><a class="" href="overlapping-indices.html"><span class="header-section-number">7</span> Overlapping indices</a></li>
<li><a class="" href="piecewise-linear-regressions.html"><span class="header-section-number">8</span> Piecewise linear regressions</a></li>
<li><a class="" href="randomization-tests.html"><span class="header-section-number">9</span> Randomization tests</a></li>
<li><a class="active" href="power-analyses-scan-version-0.54-or-later.html"><span class="header-section-number">10</span> Power analyses (scan version 0.54 or later)</a></li>
<li><a class="" href="default-settings.html"><span class="header-section-number">11</span> Default settings</a></li>
<li><a class="" href="example-datasets.html"><span class="header-section-number">12</span> Example datasets</a></li>
<li><a class="" href="exporting-scan-results.html"><span class="header-section-number">13</span> Exporting scan results</a></li>
<li><a class="" href="scplot---adavanced-plotting-functions-for-single-case-data.html"><span class="header-section-number">14</span> scplot - Adavanced plotting functions for single-case data</a></li>
<li><a class="" href="appendix.html"><span class="header-section-number">15</span> Appendix</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jazznbass/scan-Book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="power-analyses-scan-version-0.54-or-later" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Power analyses (scan version 0.54 or later)<a class="anchor" aria-label="anchor" href="#power-analyses-scan-version-0.54-or-later"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-table"><table class="table table-sm"><tr>
<td width="75px" style="background-color:#EEEEEE"><img src="images/function.png" alt="" height="49" width="45"></td> 
  <td style="background-color:#EEEEEE"><font face="Courier New" size="2"> power_test(design, method = c("plm_level", "rand", "tauU"), effect = "level", n_sim = 100, design_is_one_study = TRUE, alpha_test = TRUE, power_test = TRUE, binom_test = 0.5, alpha_level = 0.05) </font></td>
 </tr></table></div>
<div id="the-idea-of-a-power-test" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> The idea of a power-test<a class="anchor" aria-label="anchor" href="#the-idea-of-a-power-test"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>powert_test()</code> function provides the alpha error probability and power when analyzing a specific effect of a single-case design with a given statistical method.</p>
<p>For example, you have a one case design with phase length A = 10 and B = 20. You assume a strong level effect of d = 1 and you expect a slight trend effect of d = 0.02 (per measurement). You might be interested to answer two questions:</p>
<ol style="list-style-type: decimal">
<li>How suitable is a plm model for detecting the level-effect? (also: what is the power to detect the level effect?).</li>
<li>What if I had the same design but without a level-effect. How often would the plm falsely find a significant level-effect? (also: how large is the alpha-error probability for the level-effect?).</li>
</ol>
<p>In principle, <code>power_test()</code> takes a single case design and repeatedly generates random cases based on that design. Each case is now analyzed with a given statistical method. The proportion of significant effects in these analyses is an estimator of the test-power. In a second step the design is stripped of the target effect and again multiple cases are generated on this changed design and analyzed with the same method. Now, the proportion of significant effects is the estimator for the alpha-error probability.</p>
</div>
<div id="set-up-a-single-case-design" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Set up a single-case design<a class="anchor" aria-label="anchor" href="#set-up-a-single-case-design"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm"><tr>
<td width="75px" style="background-color:#EEEEEE"><img src="images/function.png" alt="" height="49" width="45"></td> 
  <td style="background-color:#EEEEEE"><font face="Courier New" size="2"> design(n = 1, phase_design = list(A = 5, B = 15), trend = 0, level = list(0), slope = list(0), start_value = 50, s = 10, rtt = 0.8, extreme_prop = list(0), extreme_range = c(-4, -3), missing_prop = 0, distribution = "normal", n_trials = NULL, mt = NULL, B_start = NULL, m, MT) </font></td>
 </tr></table></div>
<p>The <code>design</code> function sets up a single-case design. You can define various parameters of that design:</p>
<div class="inline-table"><table class=" lightable-classic" style="width: auto !important; ">
<caption>
<span id="tab:design-arguments">Table 10.1: </span>Core arguments of the design function
</caption>
<thead><tr>
<th style="text-align:left;">
Argument
</th>
<th style="text-align:left;">
What it does …
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
n
</td>
<td style="text-align:left;width: 30em; ">
Number of cases to be created (Default is n = 1).
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
phase_design
</td>
<td style="text-align:left;width: 30em; ">
A list defining the length and label of each phase. E.g., phase.length = list(A1 = 10, B1 = 10, A2 = 10, B2 = 10). Use vectors if you want to define different values for each case phase.length = list(A = c(10, 15), B = c(10, 15).
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
trend
</td>
<td style="text-align:left;width: 30em; ">
Defines the effect size of a trend added incrementally to each measurement across the whole data-set. To assign different trends to several single-cases, use a vector of values (e.g. trend = c(.1, .3, .5)). If the number of cases exceeds the length of the vector, values are recycled. When using a ‘gaussian’ distribution, the trend parameters indicate effect size d changes. When using a binomial or poisson distribution, trend indicates an increase in points / counts per measurement.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
level
</td>
<td style="text-align:left;width: 30em; ">
A list that defines the level increase (effect size d) at the beginning of each phase relative to the previous phase (e.g. list(A = 0, B = 1)). The first element must be zero as the first phase of a single-case has no level effect (if you have one less list element than the number of phases, scan will add a leading element with 0 values). Use vectors to define variable level effects for each case (e.g. list(A = c(0, 0), B = c(1, 2))). When using a ‘gaussian’ distribution, the level parameters indicate effect size d changes. When using a binomial or poisson distribution, level indicates an increase in points / counts with the onset of each phase.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
slope
</td>
<td style="text-align:left;width: 30em; ">
A list that defines the increase per measurement for each phase compared to the previous phase. slope = list(A = 0, B = .1 generates an incremental increase of 0.1 per measurement starting at the B phase. The first list element must be zero as the first phase of a single-case has no slope effect (if you have one less list element than the number of phases, scan will add a leading element with 0 values). Use vectors to define variable slope effects for each case (e.g. list(A = c(0, 0), B = c(0.1, 0.2))). If the number of cases exceeds the length of the vector, values are recycled. When using a ‘gaussian’ distribution, the slope parameters indicate effect size d changes per measurement. When using a binomial or poisson distribution, slope indicates an increase in points / counts per measurement.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
rtt
</td>
<td style="text-align:left;width: 30em; ">
Reliability of the underlying simulated measurements. Set rtt = .8 by default. To assign different reliabilities to several single-cases, use a vector of values (e.g. rtt = c(.6, .7, .8)). If the number of cases exceeds the length of the vector, values are repeated. rtt has no effect when you’re using binomial or poisson distributed scores.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
start_value
</td>
<td style="text-align:left;width: 30em; ">
Starting value at the first measurement. Default is 50. To assign different start values to several single-cases, use a vector of values (e.g. c(50, 42, 56)). If the number of cases exceeds the length of the vector, values are recycled.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
s
</td>
<td style="text-align:left;width: 30em; ">
Standard deviation used to calculate absolute values from level, slope, trend effects and to calculate and error distribution from the rtt values. Set to 10 by default. To assign different variances to several single-cases, use a vector of values (e.g. s = c(5, 10, 15)). If the number of cases exceeds the length of the vector, values are recycled. if the distribution is ‘poisson’ or ‘binomial’ s is not applied.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
extreme_prop
</td>
<td style="text-align:left;width: 30em; ">
Probability of extreme values. extreme.p = .05 gives a five percent probability of an extreme value. A vector of values assigns different probabilities to multiple cases. If the number of cases exceeds the length of the vector, values are repeated.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
extreme_range
</td>
<td style="text-align:left;width: 30em; ">
Range for extreme values, expressed as effect size d. extreme.d = c(-7,-6) uses extreme values within a range of -7 and -6 standard deviations. In case of a binomial or poisson distribution, extreme.d indicates points / counts. Caution: the first value must be smaller than the second, otherwise the procedure will fail.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
missing_prop
</td>
<td style="text-align:left;width: 30em; ">
Portion of missing values. missing.p = 0.1 creates 10% of all values as missing). A vector of values assigns different probabilities to multiple cases. If the number of cases exceeds the length of the vector, values are repeated.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
distribution
</td>
<td style="text-align:left;width: 30em; ">
Distribution of the scores. Default is distribution = ‘normal’. Possible values are ‘normal’ (or ‘gaussian’), ‘binomial’, and ‘poisson’.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 15em; ">
prob
</td>
<td style="text-align:left;width: 30em; ">
If distribution is set ‘binomial’, prob passes the probability of occurrence.
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="conducting-a-power-test" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Conducting a power-test<a class="anchor" aria-label="anchor" href="#conducting-a-power-test"><i class="fas fa-link"></i></a>
</h2>
<p>When conduction a power test you firstly need to define a design which you like to be tested.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1</span>,
  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  trend <span class="op">=</span> <span class="fl">0.02</span>,
  distribution <span class="op">=</span> <span class="st">"normal"</span>
<span class="op">)</span></code></pre></div>
<p>Then you have to choose the statistical method. The <code>power_test</code> function applies three methods by default: <em>plm</em>, <em>randomization test</em>, and <em>Tau U</em>.
These default values are only suitable when your design is a one case single-case study.</p>
<p>Let us start with the defaults and conduct a power analysis for our previously set design: <em>(This might take some time. Even in the default setting with 100 simulations you might wait a few seconds. For more precise estimations I recommend 1000 simulations - or even higher.)</em></p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span><span class="op">)</span>
<span class="va">res</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct p
 plm_level    73           5      1:5.4    84.0 0
      rand    67          10      1:3.3    78.5 0
      tauU   100          25      1:0.0    87.5 0</code></pre>
<p>The results show that the plm test and the randomization test have similar power and alpha-error probabilities (the differences here may be due to outliers of the random samples. A more intensive computation with 1000 simulations shows slightly better values for the plm). The tau U test has an unacceptably high alpha-error which is due to the trend we put into the design. <em>Alpha:Beta</em> depicts the relation of the Alpha and Beta error (power = 1 - Beta). <em>Correct</em> is the overall proportion of correct categorizations and <em>p</em> is the results of a binomial-test of <em>Correct</em> against 50%.</p>
</div>
<div id="statistical-methods" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Statistical methods<a class="anchor" aria-label="anchor" href="#statistical-methods"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>method</code> argument takes a list where each element depicts a statistical method. Currently, the following character strings are predefined:</p>
<div class="inline-table"><table class=" lightable-classic" style="width: auto !important; ">
<caption>
<span id="tab:table-mc-func">Table 10.2: </span>Statistical methods
</caption>
<thead><tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Single/ multiple cases
</th>
<th style="text-align:left;">
What it means …
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_level
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A complete plm model for normal distributed dependent variables. It checks for the level effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_slope
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A complete plm model for normal distributed dependent variables. It checks for the slope effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_poisson_level
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
Like plm_level but for poisson distributed dependent variables.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
plm_poisson_slope
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
Like plm_slope but for poisson distributed dependent variables.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
hplm_level
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
A complete hplm model for normal distributed dependent variables. It checks for the level effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
hplm_slope
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
A complete hplm model for normal distributed dependent variables. It checks for the slope effect.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU
</td>
<td style="text-align:left;width: 7em; ">
sinlge
</td>
<td style="text-align:left;">
A tauU test with method complete and taub estimations. It checks the ‘A vs. B - Trend A’ variation.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_slope
</td>
<td style="text-align:left;width: 7em; ">
sinlge
</td>
<td style="text-align:left;">
A tauU test with method complete and taub estimations. It checks the ‘A vs. B - Trend A + Trend B’ variation.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_meta
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
Like ‘TauU’ but with the results from a meta analyses (fixed effects). Very slow.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
tauU_slope_meta
</td>
<td style="text-align:left;width: 7em; ">
multiple
</td>
<td style="text-align:left;">
Like ‘TauU_slope’ but with the results from a meta analyses (fixed effects). Very slow.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
base_tau
</td>
<td style="text-align:left;width: 7em; ">
single
</td>
<td style="text-align:left;">
A baseline corrected tau test.
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;width: 10em; ">
rand
</td>
<td style="text-align:left;width: 7em; ">
single and multiple
</td>
<td style="text-align:left;">
A randomization test for ‘Mean B-A’ with 100 permutations.
</td>
</tr>
</tbody>
</table></div>
<div id="advanced-methods" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> Advanced methods<a class="anchor" aria-label="anchor" href="#advanced-methods"><i class="fas fa-link"></i></a>
</h3>
<p><em>Note: You need specific knowledge on how to create functions in R and on data structures to follow all aspects of this section.</em></p>
<p>Instead of one of the predefined character strings you can also create you own functions and implement these. You function must take an scdf as the first argument and return a single numeric p-value.</p>
<p>Here is an example of a fast plm function for poisson distributed data based on the <code>fastglm</code> package:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plm_fast</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">data</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="va">y</span>  <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">values</span>
  <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span>
  <span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">phase</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">)</span>
  <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n2</span><span class="op">)</span><span class="op">)</span>
  <span class="va">mt</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">mt</span>
  <span class="va">inter</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mt</span> <span class="op">-</span> <span class="va">mt</span><span class="op">[</span><span class="va">n1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">D</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span><span class="op">)</span>, <span class="va">mt</span>, <span class="va">D</span>, <span class="va">inter</span><span class="op">)</span>,
    nrow <span class="op">=</span> <span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span>,
    ncol <span class="op">=</span> <span class="fl">4</span>
  <span class="op">)</span>
  <span class="va">full</span> <span class="op">&lt;-</span> <span class="fu">fastglm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fastglm/man/fastglm.html">fastglm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">full</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"fast plm"</span> <span class="op">=</span> <span class="va">plm_fast</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="computation-duration" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Computation duration<a class="anchor" aria-label="anchor" href="#computation-duration"><i class="fas fa-link"></i></a>
</h2>
<p>You can print the returning object of the <code>power_test</code> function with added computation duration time by setting <code>duration = TRUE</code></p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res</span>, duration <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>Test-Power in percent:

    Method Power Alpha Error Alpha:Beta Correct p
 plm_level    73           5      1:5.4    84.0 0
      rand    67          10      1:3.3    78.5 0
      tauU   100          25      1:0.0    87.5 0

Computation duration is 1 seconds.</code></pre>
<p>The duration depends heavily on the applied test methods. Regressions are faster than randomization tests and tau U tests are quiet slow:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="st">"plm_level"</span><span class="op">)</span>
<span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span>
<span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="st">"tauU"</span><span class="op">)</span>

<span class="co"># Elapsed time in seconds for each procedure</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"computation_duration"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">elapsed</span> 
  <span class="fl">0.073</span> 
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"computation_duration"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">elapsed</span> 
  <span class="fl">0.209</span> 
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">res3</span>, <span class="st">"computation_duration"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">elapsed</span> 
  <span class="fl">0.706</span> </code></pre></div>
<p>… and what about our fast-glm function?</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">1</span>,
  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  trend <span class="op">=</span> <span class="fl">0.02</span>,
  distribution <span class="op">=</span> <span class="st">"poisson"</span>
<span class="op">)</span>

<span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"fast plm"</span> <span class="op">=</span> <span class="va">plm_fast</span><span class="op">)</span><span class="op">)</span>
<span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">power_test</span><span class="op">(</span><span class="va">design</span>, method <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"computation_duration"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>elapsed 
  0.125 </code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"computation_duration"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>elapsed 
  0.206 </code></pre>
<p>… it is more that two times faster!</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="randomization-tests.html"><span class="header-section-number">9</span> Randomization tests</a></div>
<div class="next"><a href="default-settings.html"><span class="header-section-number">11</span> Default settings</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#power-analyses-scan-version-0.54-or-later"><span class="header-section-number">10</span> Power analyses (scan version 0.54 or later)</a></li>
<li><a class="nav-link" href="#the-idea-of-a-power-test"><span class="header-section-number">10.1</span> The idea of a power-test</a></li>
<li><a class="nav-link" href="#set-up-a-single-case-design"><span class="header-section-number">10.2</span> Set up a single-case design</a></li>
<li><a class="nav-link" href="#conducting-a-power-test"><span class="header-section-number">10.3</span> Conducting a power-test</a></li>
<li>
<a class="nav-link" href="#statistical-methods"><span class="header-section-number">10.4</span> Statistical methods</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#advanced-methods"><span class="header-section-number">10.4.1</span> Advanced methods</a></li></ul>
</li>
<li><a class="nav-link" href="#computation-duration"><span class="header-section-number">10.5</span> Computation duration</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jazznbass/scan-Book/blob/master/ch_powertest.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jazznbass/scan-Book/edit/master/ch_powertest.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Analyzing single-case data with R and scan</strong>" was written by Jürgen Wilbert. It was last built on 2022-06-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
