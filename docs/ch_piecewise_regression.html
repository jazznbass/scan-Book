<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Piecewise linear regressions – Analyzing Single-Case Data with R and scan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch_multilevel_plm.html" rel="next">
<link href="./ch_overlapping_indices.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4b670b43c39165ebd99c74de5d376732.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch_describe.html">Data analysis</a></li><li class="breadcrumb-item"><a href="./ch_piecewise_regression.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Piecewise linear regressions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./cover.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./cover.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analyzing Single-Case Data with R and scan</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jazznbass/scan-Book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_scan_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The scan package</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">The single-case data frame</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_create_display_and_store_scdfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Create, display, and store single-case data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_working_with_scdfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with <em>single-case data frames</em></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_scplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Creating a single-case data plot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_helper_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Setting variables for analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_missing_values_outliers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Missing values and outliers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Describe single-case data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_overlapping_indices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Overlapping indices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_piecewise_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Piecewise linear regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_multilevel_plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multilevel plm analyses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_multivariate_plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multivariate piecewise regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_bayesian_plm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Bayesian regression analyses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_randomization_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Randomization tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_powertest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Power analyses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">More</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Exporting <em>scan</em> results</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch_shinyscan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Graphical user interface - Shinyscan</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app_some_things.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Some things about R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Changes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app_default_settings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Default settings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app_supseded_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Supseded functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app_author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">About the author</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-basic-plm-function" id="toc-the-basic-plm-function" class="nav-link active" data-scroll-target="#the-basic-plm-function"><span class="header-section-number">10.1</span> The basic plm function</a></li>
  <li><a href="#autocorrelation-of-the-residuals" id="toc-autocorrelation-of-the-residuals" class="nav-link" data-scroll-target="#autocorrelation-of-the-residuals"><span class="header-section-number">10.2</span> Autocorrelation of the residuals</a></li>
  <li><a href="#sec-rescale" id="toc-sec-rescale" class="nav-link" data-scroll-target="#sec-rescale"><span class="header-section-number">10.3</span> Standardizing predictors</a></li>
  <li><a href="#adjusting-the-model" id="toc-adjusting-the-model" class="nav-link" data-scroll-target="#adjusting-the-model"><span class="header-section-number">10.4</span> Adjusting the model</a>
  <ul class="collapse">
  <li><a href="#the-slope-level-and-trend-arguments" id="toc-the-slope-level-and-trend-arguments" class="nav-link" data-scroll-target="#the-slope-level-and-trend-arguments"><span class="header-section-number">10.4.1</span> The <code>slope</code>, <code>level</code>, and <code>trend</code> arguments</a></li>
  </ul></li>
  <li><a href="#adding-additional-predictors" id="toc-adding-additional-predictors" class="nav-link" data-scroll-target="#adding-additional-predictors"><span class="header-section-number">10.5</span> Adding additional predictors</a></li>
  <li><a href="#frequencies-and-proportions" id="toc-frequencies-and-proportions" class="nav-link" data-scroll-target="#frequencies-and-proportions"><span class="header-section-number">10.6</span> Frequencies and proportions</a>
  <ul class="collapse">
  <li><a href="#bounded-frequencies" id="toc-bounded-frequencies" class="nav-link" data-scroll-target="#bounded-frequencies"><span class="header-section-number">10.6.1</span> Bounded frequencies</a></li>
  <li><a href="#proportions" id="toc-proportions" class="nav-link" data-scroll-target="#proportions"><span class="header-section-number">10.6.2</span> Proportions</a></li>
  <li><a href="#dichotomous-outcomes" id="toc-dichotomous-outcomes" class="nav-link" data-scroll-target="#dichotomous-outcomes"><span class="header-section-number">10.6.3</span> Dichotomous outcomes</a></li>
  <li><a href="#unbounded-frequencies" id="toc-unbounded-frequencies" class="nav-link" data-scroll-target="#unbounded-frequencies"><span class="header-section-number">10.6.4</span> Unbounded frequencies</a></li>
  </ul></li>
  <li><a href="#sec-anova" id="toc-sec-anova" class="nav-link" data-scroll-target="#sec-anova"><span class="header-section-number">10.7</span> Model comparison (since version 0.64.0)</a></li>
  <li><a href="#sec-dummy-model" id="toc-sec-dummy-model" class="nav-link" data-scroll-target="#sec-dummy-model"><span class="header-section-number">10.8</span> Dummy models</a></li>
  <li><a href="#designs-with-more-than-two-phases-setting-the-right-contrasts" id="toc-designs-with-more-than-two-phases-setting-the-right-contrasts" class="nav-link" data-scroll-target="#designs-with-more-than-two-phases-setting-the-right-contrasts"><span class="header-section-number">10.9</span> Designs with more than two phases: Setting the right contrasts</a></li>
  <li><a href="#understanding-and-interpreting-contrasts" id="toc-understanding-and-interpreting-contrasts" class="nav-link" data-scroll-target="#understanding-and-interpreting-contrasts"><span class="header-section-number">10.10</span> Understanding and interpreting contrasts</a>
  <ul class="collapse">
  <li><a href="#phase-b-estimates" id="toc-phase-b-estimates" class="nav-link" data-scroll-target="#phase-b-estimates"><span class="header-section-number">10.10.1</span> Phase B estimates</a></li>
  <li><a href="#phase-c-estimates" id="toc-phase-c-estimates" class="nav-link" data-scroll-target="#phase-c-estimates"><span class="header-section-number">10.10.2</span> Phase C estimates</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jazznbass/scan-Book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch_describe.html">Data analysis</a></li><li class="breadcrumb-item"><a href="./ch_piecewise_regression.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Piecewise linear regressions</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-plm" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Piecewise linear regressions</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>In a piecewise-regression analysis (sometimes called segmented regression) a dataset is split at a particular break point and the regression parameters (intercept and slopes) are calculated separately for the data before and after the break point. This is done because we assume that there is a qualitative change at the break point that affects the intercept and slope. This approach is well suited to the analysis of single-case data which are from a statistical point of view time-series data segmented into phases. A general model for single-case data based on the piecewise regression approach has been proposed by Huitema and McKean <span class="citation" data-cites="huitema_design_2000">Huitema &amp; Mckean (<a href="references.html#ref-huitema_design_2000" role="doc-biblioref">2000</a>)</span>. They refer to two-phase single-case designs with a pre-intervention phase containing some measurements before the start of the intervention (A-phase) and an intervention phase containing measurements starting at the beginning of the intervention and continuing throughout intervention (B-phase).</p>
<p>In this model, four parameters predict the outcome at a specific measurement point <a href="#fig-plm" class="quarto-xref">see&nbsp;<span>10.1</span></a></p>
<ol type="1">
<li><p>The performance at the beginning of the study (<strong>intercept</strong>),</p></li>
<li><p>a developmental effect leading to a continuous increase throughout all measurements (<strong>trend effect</strong>),</p></li>
<li><p>an intervention effect leading to an immediate and constant increase in performance (<strong>level effect</strong>), and</p></li>
<li><p>a second intervention effect that evolves continuously with the beginning of the intervention (<strong>slope effect</strong>).</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-plm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ch_piecewise_regression_files/figure-html/fig-plm-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Illustration of the piecewise-linear model
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>The regression model
</div>
</div>
<div class="callout-body-container callout-body">
<p>The default model applied in the plm function has the formula</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 (time_i-time_1) + \beta_2 phase_i + \beta_3 (time_i-time_{n_A+1})*phase_i
\]</span></p>
<p>Where:</p>
<p><span class="math inline">\(i\)</span> := the session<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> number.</p>
<p><span class="math inline">\(\beta_0\)</span> := the intercept.</p>
<p><span class="math inline">\(\beta_1 time\)</span> := the continuous effect of the measurement time (the trend effect).</p>
<p><span class="math inline">\(\beta_2 phase\)</span> := the discrete effect of the phase switch (the level effect).</p>
<p><span class="math inline">\(\beta_3 (time-n_{A+1})*phase\)</span> := the continuous effect of the phase switch (the slope effect).</p>
<p><span class="math inline">\(n_{A+1}\)</span> := the first session of phase B.</p>
<p>For <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_3\)</span>, the time variables are shifted to start with a 0 at the first session of the respective phase.</p>
</div>
</div>
<p><em>scan</em> provides an implementation based on this piecewise-regression approach. Though the original model is extended by several factors:</p>
<ul>
<li>multiple phase designs</li>
<li>additional (control) variables</li>
<li>autoregression modelling</li>
<li>logistic, binomial, and poisson distributed dependent variables and error terms</li>
<li>multivariate analyses for analysing the effect of an intervention on more than one outcome variable (see <a href="ch_multivariate_plm.html" class="quarto-xref"><span>Chapter 12</span></a>).</li>
<li>multilevel analyses for multiple cases (see <a href="ch_multilevel_plm.html" class="quarto-xref"><span>Chapter 11</span></a>).</li>
</ul>
<section id="the-basic-plm-function" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="the-basic-plm-function"><span class="header-section-number">10.1</span> The basic plm function</h2>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The plm function call:
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>plm</strong>(<br>
&nbsp;&nbsp;<em>data</em>,<br>
&nbsp;&nbsp;<em>dvar</em>,<br>
&nbsp;&nbsp;<em>pvar</em>,<br>
&nbsp;&nbsp;<em>mvar</em>,<br>
&nbsp;&nbsp;<em>AR</em> = 0,<br>
&nbsp;&nbsp;<em>model</em> = c(“W”, “H-M”, “B&amp;L-B”, “JW”),<br>
&nbsp;&nbsp;<em>family</em> = “gaussian”,<br>
&nbsp;&nbsp;<em>trend</em> = TRUE,<br>
&nbsp;&nbsp;<em>level</em> = TRUE,<br>
&nbsp;&nbsp;<em>slope</em> = TRUE,<br>
&nbsp;&nbsp;<em>contrast</em> = c(“first”, “preceding”),<br>
&nbsp;&nbsp;<em>contrast_level</em> = c(NA, “first”, “preceding”),<br>
&nbsp;&nbsp;<em>contrast_slope</em> = c(NA, “first”, “preceding”),<br>
&nbsp;&nbsp;<em>formula</em> = NULL,<br>
&nbsp;&nbsp;<em>update</em> = NULL,<br>
&nbsp;&nbsp;<em>na.action</em> = na.omit,<br>
&nbsp;&nbsp;<em>r_squared</em> = TRUE,<br>
&nbsp;&nbsp;<em>var_trials</em> = NULL,<br>
&nbsp;&nbsp;<em>dvar_percentage</em> = FALSE,<br>
&nbsp;&nbsp;<em>…</em><br>
)</p>
</div>
</div>
<p>The basic function for applying a regression analyses to a single-case dataset is <code>plm</code>. This function analyses one single-case. In its simplest way, <code>plm</code> takes one argument with an <em>scdf</em> object and it returns a full piecewise-regression analyses.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(exampleAB<span class="sc">$</span>Johanna)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a gaussian distribution.
F(3, 16) = 28.69; p = 0.000; R² = 0.843; Adjusted R² = 0.814; AIC = 126.8444

                            B LL-CI95% UL-CI95%    SE      t     p delta R²
Intercept              54.400   46.776   62.024 3.890 13.986 0.000         
Trend (mt)              0.100   -3.012    3.212 1.588  0.063 0.951    0.000
Level phase B (phaseB)  7.858   -3.542   19.258 5.816  1.351 0.195    0.018
Slope phase B (interB)  1.525   -1.642    4.692 1.616  0.944 0.359    0.009

Autocorrelations of the residuals
 lag    cr
   1 -0.32
   2 -0.13
   3 -0.01
Ljung-Box test: X²(3) = 2.84; p = 0.417 

Formula: values ~ 1 + mt + phaseB + interB </code></pre>
</div>
</div>
<p>The output shows the specific contrast settings for the phase and slope calculation (see below for a detailed explanation). Next, the overall model fit is provided. In this specific example the model fit is quite high explaining more than 80% of the variance of the dependent variable. The following regression table shows the unstandardised estimates (B), the lower and upper boundaries of a 95% confidence interval, the standard-error, the t-test statistic, the p-value, and the delta R squared for each predictor.</p>
<p>In this example, the intercept is the score estimation at the beginning of the study (here: at the first session, see <a href="#fig-plm-ex-1" class="quarto-xref">Figure&nbsp;<span>10.2</span></a>). The trend effect (variable <em>mt</em>) is 0.100. This means that for every one point increase in measurement-time, the score increased by 0.100. As this example has a total of 20 sessions, the overall increase due to the trend is <span class="math inline">\(19 * 0.100 = 1.9\)</span> points. The level effect (variable <em>phase</em> with level B) is 7.858. This means that all scores of phase B are increased by 7.858 points. The slope effect (for phase B) is 1.525. This means that for every one point increase in measurement time after the first phase B session, the score increases by 1.525. As there are 15 Phase B sessions in this example, the total increase due to the slope effect is <span class="math inline">\(14 * 1.525 = 21.35\)</span> points.</p>
<p>From these values each data point can be estimated. For example, the last session (<span class="math inline">\(i=20\)</span>) is estimated to be <span class="math inline">\(54.400 + 19 * 0.100 + 7.858 + 14 * 1.525 = 85.508\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-plm-ex-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plm-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ch_piecewise_regression_files/figure-html/fig-plm-ex-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plm-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Example dataset
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As a convenience, the predictors are renamed according to the respective effect within the single-case terminology that they represent.</p>
<p>If you prefer to use the original variable names, set the following option: <code>options(scan.rename.predictors = "no")</code>.</p>
<p>If you want more concise renamed predictors, set: <code>options(scan.rename.predictors = "concise")</code>.</p>
<p>You can restore the default renaming by setting: <code>options(scan.rename.predictors = "full")</code>.</p>
</div>
</div>
</section>
<section id="autocorrelation-of-the-residuals" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="autocorrelation-of-the-residuals"><span class="header-section-number">10.2</span> Autocorrelation of the residuals</h2>
<p>The output also reports the <strong>autocorrelations of the residuals</strong>, which indicate whether the models residuals are serially independent.</p>
<p>There are many reasons why this might happen. For example, in a learning study, performance may temporarily decline after a learning session (performance dip). Similarly, in a medication study, a drug might initially cause a brief worsening of symptoms before exerting its intended therapeutic effect (early symptom exacerbation effect).</p>
<p>The <em>lag</em> refers to the number of measurement points between observations that show autocorrelation.</p>
<p>The <strong>Ljung-Box</strong> test is an omnibus test that evaluates whether the residuals exhibit significant autocorrelation at multiple lags. It assesses whether the joint distribution of autocorrelations differs significantly from what would be expected under the assumption of independence.</p>
<p>High and significant autocorrelations pose a threat to the validity of standard regression models, as they violate the assumption of independent residuals. To account for this, you can set the <code>AR</code> argument with the appropriate maximum lag (e.g., <code>AR = 3</code>). This implements an <em>ARMA</em> (autoregressive moving average) model, which takes the serial correlation in the residuals into account.</p>
</section>
<section id="sec-rescale" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="sec-rescale"><span class="header-section-number">10.3</span> Standardizing predictors</h2>
<p>If you want standardized predictors, meaning that predictors are scaled to standard deviations, the best approach is to standardize all variables before computing the regression model. Use the <code>rescale()</code> function to do this.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>exampleAB<span class="sc">$</span>Johanna <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rescale</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plm</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rescaled values, mt</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a gaussian distribution.
F(3, 16) = 28.69; p = 0.000; R² = 0.843; Adjusted R² = 0.814; AIC = 28.67075

                            B LL-CI95% UL-CI95%    SE      t     p delta R²
Intercept              -1.276   -1.931   -0.621 0.334 -3.818 0.002         
Trend (mt)              0.051   -1.531    1.633 0.807  0.063 0.951    0.000
Level phase B (phaseB)  0.675   -0.304    1.655 0.500  1.351 0.195    0.018
Slope phase B (interB)  0.775   -0.835    2.385 0.821  0.944 0.359    0.009

Autocorrelations of the residuals
 lag    cr
   1 -0.32
   2 -0.13
   3 -0.01
Ljung-Box test: X²(3) = 2.84; p = 0.417 

Formula: values ~ 1 + mt + phaseB + interB </code></pre>
</div>
</div>
<p>The regression coefficients <em>B</em> are now standardized Beta (ß) coefficients, indicating the expected change (in standard deviations) of the dependent variable for a one-standard-deviation increase in the predictor.</p>
</section>
<section id="adjusting-the-model" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="adjusting-the-model"><span class="header-section-number">10.4</span> Adjusting the model</h2>
<p>The plm model is a complex model specifically suited for single-case studies. It entails a series of important parameters. Nevertheless, often we have specific theoretical assumption that do no include some of these parameters. We might, for example, only expect an immediate but not a continuous change from a medical intervention. Therefore, it would not be useful to include the slope-effect into our modelling. Vice versa, we could investigate an intervention that will just develop across time without an immediate change with the intervention start. Here we should drop the level-effect from out model. Even the assumption of a trend-effect can be dropped in cases where we do not expect a serial dependency of the data and we do not assume intervention independent changes within the time-frame of the study.</p>
<p>It is important to keep in mind, that an overly complex model might have negative effects on the test power of an analyses (that is, the probability of detecting an actually existing effect is diminished) <span class="citation" data-cites="wilbert2022">(see <a href="references.html#ref-wilbert2022" role="doc-biblioref">Wilbert, Lüke, &amp; Börnert-Ringleb, 2022</a>)</span></p>
<section id="the-slope-level-and-trend-arguments" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="the-slope-level-and-trend-arguments"><span class="header-section-number">10.4.1</span> The <code>slope</code>, <code>level</code>, and <code>trend</code> arguments</h3>
<!--# treat each argument separately and add more examples -->
<p>The plm function comes with three arguments (<code>slope</code>, <code>level</code>, and <code>trend</code>) to include or drop the respective predictors from the plm model. Buy default, all arguments are set <code>TRUE</code> and a full plm model is applied to the data.</p>
<p>Consider the following data example:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>example <span class="ot">&lt;-</span> <span class="fu">scdf</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">values =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">55</span>, <span class="dv">58</span>, <span class="dv">53</span>, <span class="dv">50</span>, <span class="dv">52</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">B =</span> <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">68</span>, <span class="dv">81</span>, <span class="dv">67</span>, <span class="dv">78</span>, <span class="dv">73</span>, <span class="dv">72</span>, <span class="dv">78</span>, <span class="dv">81</span>, <span class="dv">78</span>, <span class="dv">71</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">76</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(example)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a gaussian distribution.
F(3, 16) = 21.36; p = 0.000; R² = 0.800; Adjusted R² = 0.763; AIC = 130.3907

                            B LL-CI95% UL-CI95%    SE      t     p delta R²
Intercept              56.400   48.070   64.730 4.250 13.270 0.000         
Trend (mt)             -1.400   -4.801    2.001 1.735 -0.807 0.432    0.008
Level phase B (phaseB) 16.967    4.510   29.424 6.356  2.670 0.017    0.089
Slope phase B (interB)  2.500   -0.961    5.961 1.766  1.416 0.176    0.025

Autocorrelations of the residuals
 lag    cr
   1 -0.28
   2  0.05
   3 -0.11
Ljung-Box test: X²(3) = 2.14; p = 0.543 

Formula: values ~ 1 + mt + phaseB + interB </code></pre>
</div>
</div>
<p>The piecewise regression reveals a significant level effect and two non significant effects for trend and slope. In a further analyses we would like to put the slope effect out of the equation. The easiest way to do this is to set the <code>slope</code> argument to <code>FALSE</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(example, <span class="at">slope =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a gaussian distribution.
F(2, 17) = 29.30; p = 0.000; R² = 0.775; Adjusted R² = 0.749; AIC = 130.7511

                            B LL-CI95% UL-CI95%    SE      t     p delta R²
Intercept              51.572   46.455   56.690 2.611 19.752 0.000         
Trend (mt)              1.014    0.364    1.664 0.332  3.057 0.007    0.124
Level phase B (phaseB) 10.329    1.674   18.983 4.416  2.339 0.032    0.072

Autocorrelations of the residuals
 lag    cr
   1 -0.07
   2  0.06
   3 -0.17
Ljung-Box test: X²(3) = 0.99; p = 0.804 

Formula: values ~ 1 + mt + phaseB </code></pre>
</div>
</div>
<p>In the resulting estimations the trend and level effects are now significant. The model estimated a trend effect of 1.01 points for every one point increase in measurement-time and a level effect of 10.33 points. That is, with the beginning of the intervention (the B-phase) the score increases by <span class="math inline">\(5 x 1.01 + 10.33 = 15.38\)</span> points (the measurement-time is increases by five, from one to six, at the first session of phase B).</p>
</section>
</section>
<section id="adding-additional-predictors" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="adding-additional-predictors"><span class="header-section-number">10.5</span> Adding additional predictors</h2>
<p>In more complex analyses, additional predictors can be included in the piecewise regression model. To do this, you have to modify the regression formula <em>manually</em> using the <code>update</code> argument. The <code>update</code> argument allows you to adjust the underlying regression formula. For example, to add a new variable named <code>newVar</code>, set <code>update = .~. + newVar</code>. Here, <code>.~.</code> refers to the the internally build model formula which depends on the number of phases in your model and the setting of the <code>slope</code>, <code>level</code>, and <code>trend</code> arguments. The dot before the tilde (<code>.</code>) indicates that everything on the left-hand side of the formula (the outcome variable) remains unchanged, while the dot after the tilde means that the entire predictor specification on the right-hand side is retained. The <code>+ newVar</code> simply adds the <code>newVar</code> variable to the equation. You can add one or more variables this way, or remove variables using a minus sign (e.g., <code>-phaseA</code> or <code>-1</code>).</p>
<p>Here is an example adding the control variable <code>cigarrets</code> to the model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(exampleAB_add, <span class="at">update =</span> .<span class="sc">~</span>. <span class="sc">+</span> cigarrets)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a gaussian distribution.
F(4, 35) = 5.87; p = 0.001; R² = 0.402; Adjusted R² = 0.333; AIC = 252.1972

                      B LL-CI95% UL-CI95%    SE      t     p delta R²
Intercept        48.971   43.387   54.555 2.849 17.189 0.000         
Trend             0.392   -0.221    1.005 0.313  1.253 0.218    0.027
Level Medication  3.459   -3.382   10.301 3.490  0.991 0.328    0.017
Slope Medication -0.294   -0.972    0.384 0.346 -0.850 0.401    0.012
cigarrets        -0.221   -1.197    0.755 0.498 -0.443 0.660    0.003

Autocorrelations of the residuals
 lag    cr
   1  0.20
   2 -0.19
   3 -0.16
Ljung-Box test: X²(3) = 4.33; p = 0.228 

Formula: wellbeing ~ day + phaseMedication + interMedication + cigarrets </code></pre>
</div>
</div>
<p>The output of the plm-function shows the resulting formula for the regression model that includes the cigarettes variable:<br>
<code>Formula: wellbeing ~ day + phaseMedication + interMedication + cigarrets</code></p>
<!--#  

completely changing the regression formula:

The formula has two parts divided by a tilde. Left of the tilde is the variable to be predicted and right of it the predictors. A 1 indicates the intercept, the variable mt estimates the trend effect, phaseB the level effect of the B-phase and the variable interB the slope effect of the B-phase (the interaction of measurement-time and phase). If formula is not explicitly defined, it is set to formula = values ~ 1 + mt + phaseB + interB (assuming an AB-design) to estimate the full piecewise regression model.

-->
</section>
<section id="frequencies-and-proportions" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="frequencies-and-proportions"><span class="header-section-number">10.6</span> Frequencies and proportions</h2>
<p>When the dependent variable is a frequency, the assumption of a normal distribution is not appropriate. This section will demonstrate how to handle such cases using the <code>plm</code> function.</p>
<p>We can distinguish between a frequency without a clearly defined limit, such as the number of lightning strikes per year in a given area or the number of seizures a patient experiences in a week, and a frequency that represents a proportion, such as the number of correctly solved tasks in a test. In these cases, the dependent variable is discrete (only cardinal numbers are possible) and cannot be lower than zero. Both of these properties violate the assumptions of a Gaussian (normal) distribution.</p>
<section id="bounded-frequencies" class="level3" data-number="10.6.1">
<h3 data-number="10.6.1" class="anchored" data-anchor-id="bounded-frequencies"><span class="header-section-number">10.6.1</span> Bounded frequencies</h3>
<p>Frequencies that have a clear reference, such as “10 out of 20,” follow a binomial distribution. In these cases, set the <code>family</code> argument of the <code>plm</code> function to <code>family = "binomial"</code>.</p>
<p>Additionally, you must specify the maximum value (the “out of” part). You can either use a distinct variable in your <em>scdf</em> that defines the maximum separately for each measurement point or specify a constant value for all measurements. In both cases, you need to set the <code>var_trials</code> argument either to the name of the variable containing the maximum values or to a numeric value representing a fixed maximum.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(exampleAB_score<span class="sc">$</span>Christiano , <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">var_trials =</span> <span class="st">"trials"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a binomial distribution.
X²(3) = 240.66; p = 0.000; AIC = 120.3268

               B LL-CI95% UL-CI95%    SE      t     p     OR  LL-CI95%
Intercept -1.964   -2.793   -1.239 0.394 -4.991 0.000  0.140     0.061
Trend      0.023   -0.118    0.166 0.072  0.324 0.746  1.023     0.889
Level B    2.376    1.454    3.378 0.488  4.866 0.000 10.762     4.280
Slope B    0.038   -0.111    0.186 0.075  0.504 0.614  1.039     0.895
           UL-CI95%
Intercept     0.290
Trend         1.181
Level B      29.312
Slope B       1.204

Formula: values/trials ~ 1 + mt + phaseB + interB
weights = trials </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or equivalent as all values in trial are 20:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plm(exampleAB_score$Christiano , family = "binomial", var_trials = 20)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The output shows the estimators <em>B</em>, which are on a logit scale, and odds or odds ratios (<em>OR</em>), which are the exponentiated logits, along with their respective confidence intervals. Logits are linear, meaning that the <em>B</em> coefficients can be added to obtain the combined effect of multiple predictors. For the example above, the logit of the intercept is -1.964, corresponding to a probability of approximately 12% (for details on the calculation, see note below). The level effect is <span class="math inline">\(B = 2.376\)</span>. This means that at the start of Phase B, the logit increases to <span class="math inline">\(B = -1.964 + 2.376 = 0.412\)</span>, which corresponds to a probability of approximately 60%.</p>
<p>Odds ratios are not linear and must be multiplied to obtain a combined effect. In this example, the odds of the intercept is 0.14, calculated as <span class="math inline">\(e^{-1.964}=0.14\)</span>. For the level effect, the <em>odds ratio</em> (“<em>ratio</em>” because it indicates the change of the odds) is 10.762. The combined effect (intecept and level) gives the odds 0.14 * 10.762 = 1.50668. Converting back to the logit scale, this is <span class="math inline">\(\log(1.50668)\approx 0.41\)</span>. This result, aside from minor rounding differences, matches the value obtained by summing the respective <em>B</em> coefficients.</p>
<p>Keep in mind that, as in Gaussian regression models, the p-value for the intercept tests the null hypothesis that the true intercept is zero. In other words, it represents the probability of obtaining an intercept estimate as extreme as the one observed if the true intercept were indeed zero (i.e., the probability of a Type I error under this null hypothesis). However, in logistic regression, an intercept (or logit) of zero does not correspond to a probability of 0%; it corresponds to a probability of 50%, because <span class="math inline">\(e^{0}= Odds{1\over1}=50\%\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>What are Logits and Odds Ratios?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Logits are the logarithm of the odds: <span class="math inline">\(log(Odds)\)</span>. Odds represent the probability of an event occurring relative to it not occurring. If the odds are 4 to 1 (<span class="math inline">\(4\over1\)</span>), this means that out of 5 total events, 4 result in one category of outcome, and 1 results in the opposite outcome.</p>
<p>For example, if a horse runs five races and we expect it to win four and lose one, the odds of winning are 4 to 1 (<span class="math inline">\(4\over1\)</span>).</p>
<p>If the odds are less than 1, the probability of the event occurring is below 50%. For instance, if the odds are 0.25 (<span class="math inline">\(1\over4\)</span>), we expect the horse to win one out of five races.</p>
<p><em>Difference Between Probabilities and Odds</em></p>
<p>Probabilities and odds are related but not identical. A probability of <span class="math inline">\(1\over4\)</span> (0.25) means that the specific outcome occurs in 1 out of 4 events. Odds of <span class="math inline">\(1\over4\)</span> means that the probability of two possible outcomes is 1 against 4, meaning the event occurs 1 time for every 4 non-occurrences. In this case, odds of <span class="math inline">\(1\over4\)</span> correspond to a probability of <span class="math inline">\(1\over5\)</span> = 0.20.</p>
<p><em>Formula</em></p>
<p>The odds are calculated as:</p>
<p><span class="math display">\[Odds(y_i)=\frac{P(y_i=1)}{1-P(y_i=0)}\]</span></p>
<p>For example, if we have a probability of 25%, the odds are:</p>
<p><span class="math display">\[Odds=\frac{0.25}{0.75}={1\over3}\]</span></p>
<p>The formula for calculating logits is:</p>
<p><span class="math display">\[logit(y_i)=log(\frac{P(y_i=1)}{1-P(y_i=0)})=log(odds)\]</span></p>
<p>For example, if we have a 25% probability that is:</p>
<p><span class="math display">\[logit(P=0.25)=log(\frac{0.25}{0.75})=log({1\over3})=-1.098612\]</span></p>
<p>For calculating probabilities from logits we use:</p>
<p><span class="math display">\[P = \frac{e^{\text{logit}(B)}}{1 + e^{\text{logit}(B)}}\]</span></p>
<p>For example, a logit of <em>B</em> = -1.964 is approxomately a 12% probability:</p>
<p><span class="math display">\[P = \frac{e^{-1.964}}{1 + e^{-1.964}}\approx\frac{0.14}{1.14}\approx{0.12}\]</span></p>
</div>
</div>
</section>
<section id="proportions" class="level3" data-number="10.6.2">
<h3 data-number="10.6.2" class="anchored" data-anchor-id="proportions"><span class="header-section-number">10.6.2</span> Proportions</h3>
<p>Proportions are actually just a mathematical identical presentation of bounded frequencies (e.g.&nbsp;10 out of 20 is identical to 0.5 from 20). When your dependent variable represents proportions, set <code>family</code> to a binomial distribution <code>family = "binomial"</code>. Again, you have to provide a variable or a constant with the total number of trials with the <code>var_trials</code> argument. Finally, you have to set the <code>dvar_percentage</code> argument to <code>TRUE</code> to indicate that your dependent variable contains proportions.</p>
<p>Here is the previous example where the the frequencies are transformed to proportions. The results are identical to the calculation with frequencies.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>scdf <span class="ot">&lt;-</span> exampleAB_score<span class="sc">$</span>Christiano <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">proportions =</span> values<span class="sc">/</span>trials) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_dvar</span>(<span class="st">"proportions"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(scdf, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">var_trials =</span> <span class="st">"trials"</span>, <span class="at">dvar_percentage =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a binomial distribution.
X²(3) = 240.66; p = 0.000; AIC = 120.3268

               B LL-CI95% UL-CI95%    SE      t     p     OR  LL-CI95%
Intercept -1.964   -2.793   -1.239 0.394 -4.991 0.000  0.140     0.061
Trend      0.023   -0.118    0.166 0.072  0.324 0.746  1.023     0.889
Level B    2.376    1.454    3.378 0.488  4.866 0.000 10.762     4.280
Slope B    0.038   -0.111    0.186 0.075  0.504 0.614  1.039     0.895
           UL-CI95%
Intercept     0.290
Trend         1.181
Level B      29.312
Slope B       1.204

Formula: proportions ~ 1 + mt + phaseB + interB
weights = trials </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Percentages
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you have percentages instead of proportions as the dependent variable, divide these by 100 with the <code>transform</code> function to get proportions.<br>
<br>
<code>scdf &lt;- transform(scdf, values = values / 100)</code></p>
</div>
</div>
</section>
<section id="dichotomous-outcomes" class="level3" data-number="10.6.3">
<h3 data-number="10.6.3" class="anchored" data-anchor-id="dichotomous-outcomes"><span class="header-section-number">10.6.3</span> Dichotomous outcomes</h3>
<p>When the dependent variable is dichotomous (e.g., 0 or 1; yes or no), we can estimate a logistic regression. Logistic regression is essentially a special case of binomial regression, applied under the “extreme” condition that there is only one trial per measurement—so that each observation results in either 0% (failure) or 100% (success).</p>
<p>Here is an example dataset with a respective analysis:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch_piecewise_regression_files/figure-html/ex-plot-dichotomous-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(example_dichotomous, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">var_trials =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a binomial distribution.
X²(3) = 5.91; p = 0.116; AIC = 205.503

               B LL-CI95% UL-CI95%    SE      t     p    OR  LL-CI95%  UL-CI95%
Intercept -0.174   -1.356    0.972 0.584 -0.298 0.766 0.840     0.258     2.643
Trend     -0.029   -0.075    0.014 0.022 -1.298 0.194 0.971     0.928     1.014
Level B    1.390   -0.114    3.067 0.801  1.734 0.083 4.015     0.892    21.477
Slope B    0.031   -0.014    0.079 0.023  1.333 0.183 1.031     0.986     1.082

Formula: values/1 ~ 1 + mt + phaseB + interB
weights = 1 </code></pre>
</div>
</div>
</section>
<section id="unbounded-frequencies" class="level3" data-number="10.6.4">
<h3 data-number="10.6.4" class="anchored" data-anchor-id="unbounded-frequencies"><span class="header-section-number">10.6.4</span> Unbounded frequencies</h3>
<p>In many cases, frequency data are collected without a predetermined upper limit. For example, in a study measuring the frequency of inappropriate classroom behavior, researchers may observe lessons and count the number of disturbances. Although there may be a practical upper limit on the number of possible disturbances, the theoretical limit is infinite.</p>
<p>Another example is a study counting the number of lorries driving on a specific street. Here too, the highest possible number is undefined.</p>
<p>For this type of data, a Poisson distribution is more appropriate. To specify a Poisson model, set the <code>family</code> argument in the <code>plm()</code> function to <code>"poisson"</code>.</p>
<p>The following example shows a dataset of injured people due to an accident on an autobahn before and after implementing a speed limit:</p>
<div class="cell">
<div class="cell-output-display">
<div id="soxqwkgowz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#soxqwkgowz table {
  font-family: times, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#soxqwkgowz thead, #soxqwkgowz tbody, #soxqwkgowz tfoot, #soxqwkgowz tr, #soxqwkgowz td, #soxqwkgowz th {
  border-style: none;
}

#soxqwkgowz p {
  margin: 0;
  padding: 0;
}

#soxqwkgowz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#soxqwkgowz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#soxqwkgowz .gt_title {
  color: #333333;
  font-size: 100%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#soxqwkgowz .gt_subtitle {
  color: #333333;
  font-size: 100%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#soxqwkgowz .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #000000;
}

#soxqwkgowz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#soxqwkgowz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#soxqwkgowz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#soxqwkgowz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#soxqwkgowz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#soxqwkgowz .gt_spanner_row {
  border-bottom-style: hidden;
}

#soxqwkgowz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#soxqwkgowz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#soxqwkgowz .gt_from_md > :first-child {
  margin-top: 0;
}

#soxqwkgowz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#soxqwkgowz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#soxqwkgowz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#soxqwkgowz .gt_row_group_first td {
  border-top-width: 2px;
}

#soxqwkgowz .gt_row_group_first th {
  border-top-width: 2px;
}

#soxqwkgowz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#soxqwkgowz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#soxqwkgowz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#soxqwkgowz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#soxqwkgowz .gt_table_body {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: #000000;
}

#soxqwkgowz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_left {
  text-align: left;
}

#soxqwkgowz .gt_center {
  text-align: center;
}

#soxqwkgowz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#soxqwkgowz .gt_font_normal {
  font-weight: normal;
}

#soxqwkgowz .gt_font_bold {
  font-weight: bold;
}

#soxqwkgowz .gt_font_italic {
  font-style: italic;
}

#soxqwkgowz .gt_super {
  font-size: 65%;
}

#soxqwkgowz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#soxqwkgowz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#soxqwkgowz .gt_indent_1 {
  text-indent: 5px;
}

#soxqwkgowz .gt_indent_2 {
  text-indent: 10px;
}

#soxqwkgowz .gt_indent_3 {
  text-indent: 15px;
}

#soxqwkgowz .gt_indent_4 {
  text-indent: 20px;
}

#soxqwkgowz .gt_indent_5 {
  text-indent: 25px;
}

#soxqwkgowz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#soxqwkgowz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="3" class="gt_heading gt_title gt_font_normal"><strong>Table</strong></td>
</tr>
<tr class="gt_heading even">
<td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border"><em>Single case data frame for case A24</em></td>
</tr>
<tr class="gt_col_headings header">
<th id="injuries" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">injuries</th>
<th id="year" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">year</th>
<th id="phase" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">phase</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">239</td>
<td class="gt_row gt_center" headers="year">1996</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">263</td>
<td class="gt_row gt_center" headers="year">1997</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">264</td>
<td class="gt_row gt_center" headers="year">1998</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">277</td>
<td class="gt_row gt_center" headers="year">1999</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">283</td>
<td class="gt_row gt_center" headers="year">2000</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">296</td>
<td class="gt_row gt_center" headers="year">2001</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">228</td>
<td class="gt_row gt_center" headers="year">2002</td>
<td class="gt_row gt_center" headers="phase">A</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">136</td>
<td class="gt_row gt_center" headers="year">2003</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">133</td>
<td class="gt_row gt_center" headers="year">2004</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">106</td>
<td class="gt_row gt_center" headers="year">2005</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">123</td>
<td class="gt_row gt_center" headers="year">2006</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">96</td>
<td class="gt_row gt_center" headers="year">2007</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">97</td>
<td class="gt_row gt_center" headers="year">2008</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">103</td>
<td class="gt_row gt_center" headers="year">2009</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">138</td>
<td class="gt_row gt_center" headers="year">2010</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">129</td>
<td class="gt_row gt_center" headers="year">2011</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">136</td>
<td class="gt_row gt_center" headers="year">2012</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">142</td>
<td class="gt_row gt_center" headers="year">2013</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">113</td>
<td class="gt_row gt_center" headers="year">2014</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">177</td>
<td class="gt_row gt_center" headers="year">2015</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">151</td>
<td class="gt_row gt_center" headers="year">2016</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="injuries">106</td>
<td class="gt_row gt_center" headers="year">2017</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="injuries">71</td>
<td class="gt_row gt_center" headers="year">2018</td>
<td class="gt_row gt_center" headers="phase">B</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="3" class="gt_footnote"><em>Note.</em> Number of injuries on a German autobahn before and after implementation of a speedlimit (130km/h). Author: Ministerium fuer Infrastruktur und Landesplanung. Land Brandenburg..</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Here, a Poisson regression is applied:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(example_A24, <span class="at">family =</span> <span class="st">"poisson"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Piecewise Regression Analysis

Contrast model: W / level = first, slope = first

Fitted a poisson distribution.
X²(3) = 547.67; p = 0.000; AIC = 261.2856

               B LL-CI95% UL-CI95%    SE       t     p      OR  LL-CI95%
Intercept  5.556    5.472    5.638 0.042 131.693 0.000 258.786   237.936
Trend      0.007   -0.016    0.030 0.012   0.604 0.546   1.007     0.984
Level B   -0.806   -0.938   -0.674 0.067 -11.964 0.000   0.447     0.391
Slope B   -0.006   -0.031    0.019 0.013  -0.472 0.637   0.994     0.969
           UL-CI95%
Intercept   280.900
Trend         1.030
Level B       0.510
Slope B       1.019

Formula: injuries ~ 1 + year + phaseB + interB </code></pre>
</div>
</div>
</section>
</section>
<section id="sec-anova" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="sec-anova"><span class="header-section-number">10.7</span> Model comparison (since version 0.64.0)</h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Experimental
</div>
</div>
<div class="callout-body-container callout-body">
<p>This feature is still in an experimental state. This means that the syntax structure, arguments, and defaults may change in future scan versions and may not be backward compatible.</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The anova function call:
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>anova</strong>(<em>object</em>, <em>…</em>)</p>
</div>
</div>
<p>You can compare the fit of piecewise linear regression (plm) models using the <code>anova()</code> function. This allows for stepwise regression analyses and targeted comparisons (e.g., assessing the combined effect of slope and level changes).</p>
<p>Let’s consider an example where we begin with a null model that includes only an intercept but no additional predictors. We then sequentially add a level effect, followed by a trend effect, and finally a slope effect.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">plm</span>(exampleAB<span class="sc">$</span>Anja, <span class="at">trend =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="cn">FALSE</span>, <span class="at">slope =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">plm</span>(exampleAB<span class="sc">$</span>Anja, <span class="at">trend =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="cn">TRUE</span>, <span class="at">slope =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">plm</span>(exampleAB<span class="sc">$</span>Anja, <span class="at">trend =</span> <span class="cn">TRUE</span>, <span class="at">level =</span> <span class="cn">TRUE</span>, <span class="at">slope =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">plm</span>(exampleAB<span class="sc">$</span>Anja, <span class="at">trend =</span> <span class="cn">TRUE</span>, <span class="at">level =</span> <span class="cn">TRUE</span>, <span class="at">slope =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We start by comparing the null model to the first model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, mod1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: values ~ 1
Model 2: values ~ 1 + phaseB
  Resid. Df Resid. Dev Df Deviance      F    Pr(&gt;F)    
1        19    2410.95                                 
2        18     840.13  1   1570.8 33.655 1.697e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The output provides the <em>residuals degrees of freedom</em> (Df), the <em>deviance of the residuals</em>, and <span class="math inline">\(\Delta Df\)</span> and <span class="math inline">\(\Delta \text{Deviance}\)</span>, which are the difference of the degrees of freedom and the residual deviance of the respective model and the preceding model (here: <span class="math inline">\(\Delta \text{Df}=19 - 18 = 1\)</span> and <span class="math inline">\(\Delta \text{Deviance}=2410.95 - 840.13 = 1570.8\)</span>). Deviance is a measure of a model’s goodness of fit and is calculated as <span class="math inline">\(-2 \times \text{Likelihood}\)</span> . The test compares the difference in degrees of freedom (<span class="math inline">\(\Delta Df = 1\)</span>) and deviance (<span class="math inline">\(\Delta \text{Deviance} = 1570.8\)</span>) between the two models.</p>
<p>Since both models assume Gaussian-distributed data, an F-test is performed. The F-value is computed as:</p>
<p><span class="math display">\[
F = \frac{\text{Explained variance}}{\text{Residual variance}} = \frac{\Delta \text{Deviance}}{\text{Residual deviance} / Df} = \frac{1570.8}{\frac{840.13}{18}} = \frac{1570.8}{46.67389} = 33.655
\]</span></p>
<p>For <span class="math inline">\(F(1, 18) = 33.655\)</span>, the p-value can be obtained with:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">33.655</span>,<span class="dv">1</span>,<span class="dv">18</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.697306e-05</code></pre>
</div>
</div>
<p>Alternatively, we can conduct a <em>likelihood-ratio test</em> by setting the argument <code>test = "LRT"</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, mod1, <span class="at">test =</span> <span class="st">"LRT"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: values ~ 1
Model 2: values ~ 1 + phaseB
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1        19    2410.95                          
2        18     840.13  1   1570.8 6.581e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>This computes a <span class="math inline">\(\chi^2\)</span> test for <span class="math inline">\(\frac{\Delta \text{Deviance}}{\text{Dispersion}} = 33.655\)</span> with <span class="math inline">\(\Delta Df = 1\)</span>, where the p-value is given by:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">33.655</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.580551e-09</code></pre>
</div>
</div>
<p>We can also compare all four models as incrementally nested models in a single step:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, mod1, mod2, mod3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: values ~ 1
Model 2: values ~ 1 + phaseB
Model 3: values ~ 1 + mt + phaseB
Model 4: values ~ 1 + mt + phaseB + interB
  Resid. Df Resid. Dev Df Deviance       F    Pr(&gt;F)    
1        19    2410.95                                  
2        18     840.13  1  1570.82 52.1722 2.033e-06 ***
3        17     542.08  1   298.06  9.8994  0.006243 ** 
4        16     481.73  1    60.34  2.0043  0.176029    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Each model is compared to its predecessor. Since all models are nested and derived from the same data, the dispersion parameter for all comparisons is taken from the most complex model, here <em>mod3</em> (dispersion = 30.11).</p>
<p>In this analysis, we observe that the phase predictor introduces the strongest improvement in model fit, whereas the slope predictor does not significantly enhance the model.</p>
</section>
<section id="sec-dummy-model" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="sec-dummy-model"><span class="header-section-number">10.8</span> Dummy models</h2>
<p>The <code>model</code> argument is used to code the <em>dummy variables</em>. These <em>dummy variables</em> are used to compute the slope and level effects of the <em>phase</em> variable.<br>
The <em>phase</em> variable is categorical, identifying the phase of each measurement. Typically, categorical variables are implemented by means of dummy variables. In a piecewise regression model two phase effects have to be estimated: a level effect and a slope effect. The level effect is implemented quite straight forward: for each phase beginning with the second phase a new dummy variable is created with values of zero for all measurements except the measurements of the phase in focus where values of one are set.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">values</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">phase</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">mt</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">level B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For estimating the <em>slope effect</em> of each phase, another kind of dummy variables have to be created. Like the dummy variables for level effects the values are set to zero for all measurements except the ones of the phase in focus. Here, values start to increase with every measurement until the end of the phase.<br>
Various suggestions have been made regarding the way in which these values increase <span class="citation" data-cites="huitema_design_2000">(see <a href="references.html#ref-huitema_design_2000" role="doc-biblioref">Huitema &amp; Mckean, 2000</a>)</span>. The <em>B&amp;L-B</em> model starts with a one at the first session of the phase and increases with every session while the <em>H-M</em> model starts with a zero.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
slope B
</div></th>
</tr>
<tr class="even">
<th style="text-align: center;" data-quarto-table-cell-role="th">values</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">phase</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">mt</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">level B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">model B&amp;L-M</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">model H-M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Applying the <em>H-M</em> model will give you a “pure” level-effect while the <em>B&amp;L-B</em> model will provide an estimation of the level-effect that is actually the level-effect plus on times the slope-effect (as the model assumes that the slope variable is <em>1</em> at the first measurement of the B-phase). For most studies, the <em>H-M</em> model is more appropriate.</p>
<p>However, there is another aspect to be aware of. Usually, in single case designs, the measurement times are coded as starting with <em>1</em> and increasing in integers (1, 2, 3, …). At the same time, the estimation of the trend effect is based on the measurement time variable. In this case, the estimate of the model intercept (usually interpreted as the value at the beginning of the study) actually represents the estimate of the starting value plus one times the trend effect. Therefore, I have implemented the <em>W</em> model (since scan version <code>0.54.4</code>). Here the trend effect is estimated for a time variable shifted to start at <em>0</em>. As a result, the intercept represents the estimated value at the first measurement of the study. The <em>W</em> model treats slope estimation in the same way as the <em>H-M</em> model. That is, the measurement-time for calculating the slope effect is set to <em>0</em> for the first session of each phase. Since scan version <code>0.54.4</code> the <em>W</em> model is the default.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
mt
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
slope
</div></th>
</tr>
<tr class="even">
<th style="text-align: center;" data-quarto-table-cell-role="th">values</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">phase</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B&amp;L-M and H-M</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">W</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B&amp;L-M</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">H-M and W</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="designs-with-more-than-two-phases-setting-the-right-contrasts" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="designs-with-more-than-two-phases-setting-the-right-contrasts"><span class="header-section-number">10.9</span> Designs with more than two phases: Setting the right contrasts</h2>
<p>For single case studies with more than two phases, things get a bit more complicated. Applying the models described above to three phases would result in a comparison between each phase and the first phase (usually phase A). That is, the regression weights and significance tests indicate the differences between each phase and the values from phase A. Another common use is to compare the effects of a phase with the previous phase.</p>
<p>You can choose between these two options by setting the contrast argument. <code>contrast = "first"</code> (the default) will compare all slope and level-effects to the values in the first phase. <code>contrast = "preceding"</code> will compare the slope and level-effects to the preceding phase.</p>
<p>For the <em>preceding contrast</em>, the dummy variable for the level-effect is set to zero for all phases preceding the phase in focus and set to one for all remaining measurements. Similarly, the dummy variable for the slope-effect is set to zero for all phases preceding the phase in focus and starts at zero (or one, depending on the model setting, see <a href="#sec-dummy-model" class="quarto-xref"><span>Section 10.8</span></a>) for the first measurement of the target phase and increases until the last measurement of the case.</p>
<p>You can set the contrast differently for the level and slope effects with the arguments <code>constrast_level</code> and <code>contrast_slope</code>. Both can be either <code>"first"</code> or <code>"preceding"</code>.</p>
<p>(Note: Prior to scan version <code>0.54.4</code>, the option <code>model = "JW"</code> was identical to <code>model = "B&amp;L-B", contrast = "preceding"</code>).</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;"></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
contrast<br>
first
</div></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
contrast<br>
preceeding
</div></th>
</tr>
<tr class="even">
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
level
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
slope
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
level
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
slope
</div></th>
</tr>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">values</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">phase</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">mt</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">C</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">C</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">C</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="understanding-and-interpreting-contrasts" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="understanding-and-interpreting-contrasts"><span class="header-section-number">10.10</span> Understanding and interpreting contrasts</h2>
<p>In this section, we will calculate four plm models with different contrast settings for the same single-case data.</p>
<p>The example <em>scdf</em> is the case <em>Marie</em> from the <em>exampleABC</em> scdf (<code>exampleABC$Marie</code>)</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-marie" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-marie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ch_piecewise_regression_files/figure-html/fig-marie-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-marie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Example dataset
</figcaption>
</figure>
</div>
</div>
</div>
<p>The dark-red lines indicate the intercept and slopes when calculated separately for each phase. They are:</p>
<div class="cell">
<div id="tbl-contrasts-ex-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-contrasts-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.1: Intercept, slope, and number of measurements calculated separately for each phase
</figcaption>
<div aria-describedby="tbl-contrasts-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">intercept</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">slope</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">phase A</td>
<td style="text-align: center;">60.618</td>
<td style="text-align: center;">-1.915</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">phase B</td>
<td style="text-align: center;">74.855</td>
<td style="text-align: center;">-0.612</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">phase C</td>
<td style="text-align: center;">68.873</td>
<td style="text-align: center;">-0.194</td>
<td style="text-align: center;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now, we estimate a plm model with four contrast settings (see <a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a>):</p>
<div class="cell">
<div id="tbl-contrast-first-preceding" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-contrast-first-preceding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.2: Estimates of a piecewise-linear regression with contrast models “first” and “preceding”.
</figcaption>
<div aria-describedby="tbl-contrast-first-preceding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Contrast level</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Contrast slope</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">intercept</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">trend</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">level B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">level C</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">slope B</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">slope C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">first</td>
<td style="text-align: center;">first</td>
<td style="text-align: center;">60.618</td>
<td style="text-align: center;">-1.915</td>
<td style="text-align: center;">33.388</td>
<td style="text-align: center;">46.558</td>
<td style="text-align: center;">1.303</td>
<td style="text-align: center;">1.721</td>
</tr>
<tr class="even">
<td style="text-align: center;">preceding</td>
<td style="text-align: center;">preceding</td>
<td style="text-align: center;">60.618</td>
<td style="text-align: center;">-1.915</td>
<td style="text-align: center;">33.388</td>
<td style="text-align: center;">0.139</td>
<td style="text-align: center;">1.303</td>
<td style="text-align: center;">0.418</td>
</tr>
<tr class="odd">
<td style="text-align: center;">first</td>
<td style="text-align: center;">preceding</td>
<td style="text-align: center;">60.618</td>
<td style="text-align: center;">-1.915</td>
<td style="text-align: center;">33.388</td>
<td style="text-align: center;">33.527</td>
<td style="text-align: center;">1.303</td>
<td style="text-align: center;">0.418</td>
</tr>
<tr class="even">
<td style="text-align: center;">preceding</td>
<td style="text-align: center;">first</td>
<td style="text-align: center;">60.618</td>
<td style="text-align: center;">-1.915</td>
<td style="text-align: center;">33.388</td>
<td style="text-align: center;">13.170</td>
<td style="text-align: center;">1.303</td>
<td style="text-align: center;">1.721</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<section id="phase-b-estimates" class="level3" data-number="10.10.1">
<h3 data-number="10.10.1" class="anchored" data-anchor-id="phase-b-estimates"><span class="header-section-number">10.10.1</span> Phase B estimates</h3>
<p>All regression models in <a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> have the same estimates for <code>intercept</code> and <code>trend</code>. These are not affected by the contrasts and are identical to those for phase A in <a href="#tbl-contrasts-ex-2" class="quarto-xref">Table&nbsp;<span>10.1</span></a>. In addition, in <a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a>, the estimates for <code>levelB</code> and <code>slopeB</code> are identical since all models contrast the same phase (the first and the preceding phase are both phase A). The values here can be calculated from <a href="#tbl-contrasts-ex-2" class="quarto-xref">Table&nbsp;<span>10.1</span></a><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span id="eq-contrast-level-2"><span class="math display">\[
levelB = intercept_{phaseB} - (intercept_{phaseA} + n_{PhaseA} * slope_{phaseA})
\tag{10.1}\]</span></span></p>
<p><span class="math display">\[
33.388 \approx  74.855 - (60.618 + 10*-1.915)
\]</span></p>
<p><span id="eq-contrast-slope-2"><span class="math display">\[
slopeB = slope_{phaseB} - slope_{phaseA}
\tag{10.2}\]</span></span></p>
<p><span class="math display">\[
1.303 \approx -1.915 - (-0.612)
\]</span></p>
</section>
<section id="phase-c-estimates" class="level3" data-number="10.10.2">
<h3 data-number="10.10.2" class="anchored" data-anchor-id="phase-c-estimates"><span class="header-section-number">10.10.2</span> Phase C estimates</h3>
<p>The <code>levelC</code> and <code>slopeC</code> estimates of the regression models in <a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> are different for the various contrast models. Depending on the contrast setting, the estimates “answer” a different question. <a href="#tbl-interpretation-contrasts" class="quarto-xref">Table&nbsp;<span>10.3</span></a> provides interpretation help.</p>
<div id="tbl-interpretation-contrasts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-interpretation-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.3: Interpretations of the effect estimates in various contrast conditions
</figcaption>
<div aria-describedby="tbl-interpretation-contrasts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Contrast level</th>
<th>Contrast slope</th>
<th>Interpretation of level C effect</th>
<th>Interpretation slope C effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>first</td>
<td>first</td>
<td>What would be the value if phase A had continued until to the start of phase C and what is the difference to the actual value at the first measurement of phase C?</td>
<td>What is the difference between the slopes of phase C and A<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>?</td>
</tr>
<tr class="even">
<td>preceding</td>
<td>preceding</td>
<td>What would be the value if phase B had continued to the start of phase C and what is the difference to the actual value at the first measurement of phase C?</td>
<td>What is the difference between the slopes of phase C and B?</td>
</tr>
<tr class="odd">
<td>first</td>
<td>preceding</td>
<td>What would be the value if phase A had continued until the start of phase C (assuming a slope effect but no level effect in phase B)? And what is the difference to the actual value at the first measurement of phase C?</td>
<td>What is the difference between the slopes of phase C and B?</td>
</tr>
<tr class="even">
<td>preceding</td>
<td>first</td>
<td>What would be the value if phase B had continued until the start of phase C (assuming a level but no slope effect in phase B)? And what is the difference to the actual value at the first measurement of phase C?</td>
<td>What is the difference between the slopes of phase C and A?</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>All four models are mathematically equivalent, i.e.&nbsp;they produce the same estimates of the dependent variable. Bellow I will show how the estimates from the piecewise regression models relate to the simple regression estimates from <a href="#tbl-contrasts-ex-2" class="quarto-xref">Table&nbsp;<span>10.1</span></a>. These are <span class="math inline">\(intercept_{phaseC} = 68.873\)</span> and <span class="math inline">\(slope_{phaseC} = -0.194\)</span>.</p>
<p><strong><em>Level first and slope first contrasts</em></strong></p>
<p><a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> estimates a <code>levelC</code> increase of 46.558 compared to phase A (the intercept) and a <code>slopeC</code> increase of 1.721.</p>
<p><span id="eq-contrast-ff-1"><span class="math display">\[
levelC = intercept_{phaseC} - (Intercept_{phaseA} + n_{phaseA+B} * slope_{phaseA})
\tag{10.3}\]</span></span></p>
<p><span class="math display">\[46.558 \approx 68.873 - (60.618 + 20*-1.915) \]</span></p>
<p><span id="eq-contrast-ff-2"><span class="math display">\[
slopeC = slope_{phaseC} - slope_{phaseA}
\tag{10.4}\]</span></span></p>
<p><span class="math display">\[1.721 \approx -0.194 - (-1.915)\]</span></p>
<p><strong><em>Level preceding and slope preceding contrasts</em></strong></p>
<p><a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> estimates a <code>levelC</code> increase of 0.139 compared to phase B and a <code>slopeC</code> increase of 0.418.</p>
<p><span id="eq-contrast-pp-1"><span class="math display">\[
levelC = intercept_{phaseC} - (intercept_{phaseB} + n_{phaseB} * slope_{phaseB})
\tag{10.5}\]</span></span></p>
<p><span class="math display">\[0.139 \approx 68.873 - (74.855 + 10*-0.612)\]</span></p>
<p><span id="eq-contrast-pp-2"><span class="math display">\[
slopeC = slope_{phaseC} - slope_{phaseB}
\tag{10.6}\]</span></span></p>
<p><span class="math display">\[0.418 \approx -0.194 - (-0.612)\]</span></p>
<p><strong><em>Level first and slope preceding contrasts</em></strong></p>
<p><a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> estimates a <code>levelC</code> increase of 33.388 compared to phase A and a <code>slopeC</code> increase of 0.418.</p>
<p><span id="eq-contrast-fp-1"><span class="math display">\[
levelC = intercept_{phaseC} - (intercept_{phaseA}  + n_{phaseA} * slope_{phaseA} + n_{phaseB} * slope_{phaseB})
\tag{10.7}\]</span></span></p>
<p><span class="math display">\[
33.527 \approx 68.873 - (60.618 + 10 * -1.915 + 10 * -0.612)
\]</span></p>
<p><span id="eq-contrast-fp-2"><span class="math display">\[
slopeC = slope_{phaseC} - slope_{phaseB}
\tag{10.8}\]</span></span></p>
<p><span class="math display">\[0.418 \approx -0.194 - (-0.612)\]</span></p>
<p><strong><em>Level preceding and slope first contrasts</em></strong></p>
<p><a href="#tbl-contrast-first-preceding" class="quarto-xref">Table&nbsp;<span>10.2</span></a> estimates a <code>levelC</code> increase of 13.170 compared to phase B and a <code>slopeC</code> increase of 1.721.</p>
<p><span id="eq-contrast-pf-1"><span class="math display">\[
levelC = intercept_{phaseC} - (intercept_{phaseB} + n_{phaseB} * slope_{phaseA})
\tag{10.9}\]</span></span></p>
<p><span class="math display">\[
13.170\approx 68.873 - (74.855 + 10*-1.915)
\]</span></p>
<p><span id="eq-contrast-pf-2"><span class="math display">\[
slopeC = slope_{phaseC} - slope_{phaseA}
\tag{10.10}\]</span></span></p>
<p><span class="math display">\[
1.721 \approx -0.194 - (-1.915)
\]</span></p>
<!--# same analyses for models without level estimators and models without slope estimators -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-huitema_design_2000" class="csl-entry" role="listitem">
Huitema, B. E., &amp; Mckean, J. W. (2000). Design specification issues in time-series intervention models. <em>Educational and Psychological Measurement</em>, <em>60</em>(1), 38–58. Retrieved from <a href="http://epm.sagepub.com/content/60/1/38.short">http://epm.sagepub.com/content/60/1/38.short</a>
</div>
<div id="ref-wilbert2022" class="csl-entry" role="listitem">
Wilbert, J., Lüke, T., &amp; Börnert-Ringleb, M. (2022). Statistical power of piecewise regression analyses of single-case experimental studies addressing behavior problems. <em>Frontiers in Education Educational Psychology</em>, <em>7</em>. <a href="https://doi.org/10.3389/feduc.2022.917944">https://doi.org/10.3389/feduc.2022.917944</a>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The session is the ordinal number (1st, 2nd, 3rd, …) of the measurements. While the measurement-time (the value of the measurement-time variable at a specific session/ measurement) is often identical to the session number, this is not necessarily the case. The measurement-time sometimes represents days since the start of the study or other intervals. Therefore, I refer to <em>session</em> or <em>measurement</em> for the ordinal position of the measurement and <em>measurement-time</em> for the value of the time variable at that session number.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Differences here and in the following calculations are due to rounding errors.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The slope of phase A is the trend effect.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./ch_overlapping_indices.html" class="pagination-link" aria-label="Overlapping indices">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Overlapping indices</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch_multilevel_plm.html" class="pagination-link" aria-label="Multilevel plm analyses">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multilevel plm analyses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jazznbass/scan-Book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>